"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[563],{4799:(e,t,l)=>{l.d(t,{A:()=>h});var i=l(9379),n=l(4034),s=l(9942),a=l(2554),d=l(9488),o=l(3516),r=l(5043),c=l(6305),u=l(2030),m=l(8908),v=l(899),x=l(579);const h=e=>{var t,l;const[h,j]=(0,r.useState)(!1),p=Object.fromEntries(((null===e||void 0===e||null===(t=e.leadData)||void 0===t?void 0:t.fields)||[]).map((e=>[null===e||void 0===e?void 0:e.name,""]))),f=(0,i.A)((0,i.A)({},p),{},{createBy:JSON.parse(localStorage.getItem("user"))._id}),g=(0,o.Wx)({initialValues:f,validationSchema:v.Ik().shape((0,u.g)(null===e||void 0===e||null===(l=e.leadData)||void 0===l?void 0:l.fields)),onSubmit:(e,t)=>{let{resetForm:l}=t;w()}}),{errors:A,touched:C,values:S,handleBlur:y,handleChange:b,handleSubmit:I,setFieldValue:D}=g,w=async()=>{try{var t;j(!0),200===(await(0,c.d_)("api/form/add",(0,i.A)((0,i.A)({},S),{},{moduleId:null===e||void 0===e||null===(t=e.leadData)||void 0===t?void 0:t._id}))).status&&(e.onClose(),g.resetForm(),e.setAction((e=>!e)))}catch(l){console.log(l)}finally{j(!1)}};return(0,x.jsx)("div",{children:(0,x.jsxs)(s._s,{isOpen:e.isOpen,size:e.size,children:[(0,x.jsx)(s.QP,{}),(0,x.jsxs)(s.zj,{children:[(0,x.jsxs)(s.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Add Lead",(0,x.jsx)(a.IconButton,{onClick:e.onClose,icon:(0,x.jsx)(n.CloseIcon,{})})]}),(0,x.jsx)(s.ys,{children:(0,x.jsx)(m.A,{moduleData:e.leadData,values:S,setFieldValue:D,handleChange:b,handleBlur:y,errors:A,touched:C})}),(0,x.jsxs)(s.tb,{children:[(0,x.jsx)(a.Button,{sx:{textTransform:"capitalize"},size:"sm",disabled:!!h,variant:"brand",type:"submit",onClick:I,children:h?(0,x.jsx)(d.A,{}):"Save"}),(0,x.jsx)(a.Button,{variant:"outline",colorScheme:"red",size:"sm",sx:{marginLeft:2,textTransform:"capitalize"},onClick:()=>{g.resetForm(),e.onClose()},children:"Close"})]})]})]})})}},8878:(e,t,l)=>{l.d(t,{A:()=>p});var i=l(9379),n=l(4034),s=l(9942),a=l(2554),d=l(4450),o=l(9488),r=l(3516),c=l(5043),u=l(3216),m=l(6305),v=l(2030),x=l(8908),h=l(899),j=l(579);const p=e=>{var t,l;const[p,f]=(0,c.useState)(!1),g=Object.fromEntries(((null===e||void 0===e||null===(t=e.leadData)||void 0===t?void 0:t.fields)||[]).map((e=>[null===e||void 0===e?void 0:e.name,""]))),[A,C]=(0,c.useState)((0,i.A)((0,i.A)({},g),{},{createBy:JSON.parse(localStorage.getItem("user"))._id})),S=(0,u.g)(),y=(0,r.Wx)({initialValues:A,enableReinitialize:!0,validationSchema:h.Ik().shape((0,v.g)(null===e||void 0===e||null===(l=e.leadData)||void 0===l?void 0:l.fields)),onSubmit:(e,t)=>{let{resetForm:l}=t;E()}}),{errors:b,touched:I,values:D,handleBlur:w,handleChange:k,handleSubmit:z,setFieldValue:B}=y,E=async()=>{try{f(!0),200===(await(0,m.yP)("api/form/edit/".concat((null===e||void 0===e?void 0:e.selectedId)||S.id),(0,i.A)((0,i.A)({},D),{},{moduleId:e.moduleId}))).status&&(e.onClose(),e.setAction((e=>!e)))}catch(t){console.log(t)}finally{f(!1)}},F=()=>{e.onClose(!1),e.setSelectedId&&(null===e||void 0===e||e.setSelectedId()),y.resetForm()};let O;return(0,c.useEffect)((()=>{(async()=>{if(null!==e&&void 0!==e&&e.selectedId||S.id)try{var t,l;f(!0),O=await(0,m.x4)("api/lead/view/",null!==e&&void 0!==e&&e.selectedId?null===e||void 0===e?void 0:e.selectedId:S.id);let n=null===(t=O)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.lead;C((e=>(0,i.A)((0,i.A)({},e),n)))}catch(n){console.error(n)}finally{f(!1)}})()}),[null===e||void 0===e?void 0:e.selectedId]),(0,j.jsx)("div",{children:(0,j.jsxs)(s._s,{isOpen:e.isOpen,size:e.size,children:[(0,j.jsx)(s.QP,{}),(0,j.jsxs)(s.zj,{children:[(0,j.jsxs)(s.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Edit Lead",(0,j.jsx)(a.IconButton,{onClick:F,icon:(0,j.jsx)(n.CloseIcon,{})})]}),(0,j.jsx)(s.ys,{children:p?(0,j.jsx)(d.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,j.jsx)(o.A,{})}):(0,j.jsx)(x.A,{moduleData:e.leadData,values:D,setFieldValue:B,handleChange:k,handleBlur:w,errors:b,touched:I})}),(0,j.jsxs)(s.tb,{children:[(0,j.jsx)(a.Button,{sx:{textTransform:"capitalize"},variant:"brand",size:"sm",type:"submit",disabled:!!p,onClick:z,children:p?(0,j.jsx)(o.A,{}):"Update"}),(0,j.jsx)(a.Button,{variant:"outline",colorScheme:"red",size:"sm",sx:{marginLeft:2,textTransform:"capitalize"},onClick:F,children:"Close"})]})]})]})})}},5563:(e,t,l)=>{l.r(t),l.d(t,{default:()=>G});var i=l(4034),n=l(1206),s=l(9754),a=l(4450),d=l(8858),o=l(5376),r=l(2554),c=l(962),u=l(216),m=l(3994),v=l(9488),x=l(2770),h=l(5043),j=l(4960),p=l(3216),f=l(5475),g=l(2145),A=l(6305),C=l(3278),S=l(8879),y=l(4406),b=l(6),I=l(6654),D=l(9250),w=l(4799),k=l(8878),z=l(5574),B=l(2853),E=l(9702),F=l(8618),O=l(8177),H=l(9367),T=l(579);const G=()=>{var e,t,l,G,N,L,_,V,R,W,U;const J=(0,p.g)(),K=JSON.parse(localStorage.getItem("user")),M=(0,n.dU)("gray.500","white"),[P,Q]=(0,h.useState)(),[Z,$]=(0,h.useState)([]),{isOpen:q,onOpen:X,onClose:Y}=(0,s.j1)(),[ee,te]=(0,h.useState)(!1),[le,ie]=(0,h.useState)(!1),[ne,se]=(0,h.useState)(!1),[ae,de]=(0,h.useState)(!1),[oe,re]=(0,h.useState)(!1),[ce,ue]=(0,h.useState)(!1),[me,ve]=(0,h.useState)(!1),[xe,he]=(0,h.useState)(!1),[je,pe]=(0,h.useState)(!1),[fe,ge]=(0,h.useState)(!1),[Ae,Ce]=(0,h.useState)([]),Se=(0,p.Zp)(),[ye,be]=(0,h.useState)(!1),[Ie,De]=(0,h.useState)(!1),[we,ke,ze,Be,Ee,Fe,Oe]=(0,z.h)(["Leads","Tasks","Meetings","Calls","Emails","Tasks","Meetings"]),He=[{Header:"sender",accessor:"senderName"},{Header:"recipient",accessor:"createByName"},{Header:"time stamp",accessor:"timestamp"},{Header:"Created",accessor:"createBy"}],Te=async e=>{if(e){let t=await(0,A.x4)("api/document/download/",e);t&&200===t.status?(window.open("".concat(x.d.baseUrl,"api/document/download/").concat(e)),g.oR.success("file Download successful")):t&&404===t.response.status&&g.oR.error("file Not Found")}},Ge=async()=>{var e;se(!0);let t=await(0,A.x4)("api/lead/view/",J.id);Q(null===(e=t.data)||void 0===e?void 0:e.lead),$(t.data),se(!1)};(0,h.useEffect)((()=>{Ge()}),[fe]);const Ne=async()=>{const e=await(0,A.x4)("api/custom-field?moduleName=Leads");Ce(e.data)};return(0,h.useEffect)((()=>{Ne&&Ne()}),[fe]),(0,T.jsxs)(T.Fragment,{children:[q&&(0,T.jsx)(w.A,{isOpen:q,size:"lg",onClose:Y,setLeadData:Ce,leadData:Ae[0],setAction:ge}),(0,T.jsx)(k.A,{isOpen:ee,size:"lg",onClose:te,setLeadData:Ce,leadData:Ae[0],setAction:ge,moduleId:null===Ae||void 0===Ae||null===(e=Ae[0])||void 0===e?void 0:e._id}),(0,T.jsx)(O.A,{isOpen:le,onClose:()=>ie(!1),type:"Lead",handleDeleteData:async e=>{try{se(!0),200===(await(0,A.Gx)("api/lead/delete/",e)).status&&(ie(!1),ge((e=>!e)),Se("/lead"))}catch(t){console.log(t)}finally{se(!1)}},ids:J.id}),ne?(0,T.jsx)(a.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,T.jsx)(v.A,{})}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(d.tU,{children:[(0,T.jsxs)(a.Grid,{templateColumns:"repeat(12, 1fr)",mb:3,gap:1,children:[(0,T.jsx)(a.GridItem,{colSpan:{base:12,md:6},children:(0,T.jsxs)(d.wb,{sx:{border:"none","& button:focus":{boxShadow:"none"},"& button":{margin:{sm:"0 3px",md:"0 5px"},padding:{sm:"5px",md:"8px"},border:"2px solid #8080803d",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",borderBottom:0,fontSize:{sm:"12px",md:"16px"}},'& button[aria-selected="true"]':{border:"2px solid brand.200",borderBottom:0,zIndex:"0"}},children:[(0,T.jsx)(d.oz,{children:"Information"}),((null===Ee||void 0===Ee?void 0:Ee.view)||(null===Be||void 0===Be?void 0:Be.view)||(null===Fe||void 0===Fe?void 0:Fe.view)||(null===Oe||void 0===Oe?void 0:Oe.view))&&(0,T.jsx)(d.oz,{children:" Communication"}),(0,T.jsx)(d.oz,{children:"Document"})]})}),(0,T.jsx)(a.GridItem,{colSpan:{base:12,md:6},mt:{sm:"3px",md:"5px"},children:(0,T.jsxs)(a.Flex,{justifyContent:"right",children:[(0,T.jsxs)(o.W1,{children:[("superAdmin"===K.role||(null===we||void 0===we?void 0:we.create)||(null===we||void 0===we?void 0:we.update)||(null===we||void 0===we?void 0:we.delete))&&(0,T.jsx)(o.IU,{size:"sm",variant:"outline",colorScheme:"blackAlpha",mr:2.5,as:r.Button,rightIcon:(0,T.jsx)(i.ChevronDownIcon,{}),children:"Actions"}),(0,T.jsx)(o.Nj,{}),(0,T.jsxs)(o.cO,{minWidth:2,children:[("superAdmin"===K.role||(null===we||void 0===we?void 0:we.create))&&(0,T.jsx)(o.Dr,{color:"blue",onClick:()=>X(),alignItems:"start",icon:(0,T.jsx)(i.AddIcon,{}),children:"Add"}),("superAdmin"===K.role||(null===we||void 0===we?void 0:we.update))&&(0,T.jsx)(o.Dr,{onClick:()=>te(!0),alignItems:"start",icon:(0,T.jsx)(i.EditIcon,{}),children:"Edit"}),("superAdmin"===K.role||(null===we||void 0===we?void 0:we.delete))&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(o.Nj,{}),(0,T.jsx)(o.Dr,{alignItems:"start",color:"red",onClick:()=>ie(!0),icon:(0,T.jsx)(i.DeleteIcon,{}),children:"Delete"})]})]})]}),(0,T.jsx)(f.N_,{to:"/lead",children:(0,T.jsx)(r.Button,{leftIcon:(0,T.jsx)(j.m6W,{}),size:"sm",variant:"brand",children:"Back"})})]})})]}),(0,T.jsxs)(d.T2,{children:[(0,T.jsx)(d.Kp,{pt:4,p:0,children:(0,T.jsx)(E.A,{data:Ae[0],fieldData:P,toCamelCase:function(e){return null===e||void 0===e?void 0:e.replace(/([a-z])([A-Z])/g,"$1 $2")}})}),(0,T.jsx)(d.Kp,{pt:4,p:0,children:(0,T.jsx)(a.GridItem,{colSpan:{base:4},children:(0,T.jsx)(a.Grid,{overflow:"hidden",templateColumns:{base:"1fr"},gap:4,children:(0,T.jsxs)(a.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(null===Ee||void 0===Ee?void 0:Ee.view)&&(0,T.jsx)(a.GridItem,{colSpan:{base:12,md:6},children:(0,T.jsxs)(u.A,{children:[(0,T.jsx)(C.A,{fetchData:Ge,viewData:Z,emailAccess:Ee,columnsData:He,lead:"true",tableData:oe?Z.Email:(null===Z||void 0===Z||null===(t=Z.Email)||void 0===t?void 0:t.length)>0?[Z.Email[0]]:[],title:"Email "}),(0,T.jsx)(b.A,{viewData:Z,fetchData:Ge,isOpen:ye,onClose:be,data:null===P||void 0===P?void 0:P.contact,setAction:ge,lead:"true",id:J.id}),(null===(l=Z.Email)||void 0===l?void 0:l.length)>1&&(0,T.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,T.jsx)(r.Button,{size:"sm",colorScheme:"brand",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>re(!oe),children:oe?"Show less":"Show more"})})]})}),(null===Be||void 0===Be?void 0:Be.view)&&(0,T.jsx)(a.GridItem,{colSpan:{base:12,md:6},children:(0,T.jsxs)(u.A,{children:[(0,T.jsx)(y.A,{callAccess:Be,fetchData:Ge,columnsData:He,lead:"true",tableData:ce?null===Z||void 0===Z?void 0:Z.phoneCall:(null===Z||void 0===Z||null===(G=Z.phoneCall)||void 0===G?void 0:G.length)>0?[null===Z||void 0===Z?void 0:Z.phoneCall[0]]:[],title:"Call "}),(null===Z||void 0===Z||null===(N=Z.phoneCall)||void 0===N?void 0:N.length)>1&&(0,T.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,T.jsx)(r.Button,{size:"sm",colorScheme:"brand",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>ue(!ce),children:ce?"Show less":"Show more"})}),(0,T.jsx)(D.A,{viewData:Z,fetchData:Ge,isOpen:Ie,onClose:De,setAction:ge,data:null===P||void 0===P?void 0:P.contact,id:J.id,lead:"true"})]})}),(null===Fe||void 0===Fe?void 0:Fe.view)&&(0,T.jsx)(a.GridItem,{colSpan:{base:12,md:6},children:(0,T.jsxs)(u.A,{children:[(0,T.jsx)(S.A,{fetchData:Ge,columnsData:[{Header:"Title",accessor:"title"},{Header:"Category",accessor:"category"},{Header:"Assign To",accessor:"assignmentToName"},{Header:"Start Date",accessor:"start"},{Header:"End Date",accessor:"end"}],lead:"true",tableData:me?null===Z||void 0===Z?void 0:Z.task:(null===Z||void 0===Z||null===(L=Z.task)||void 0===L?void 0:L.length)>0?[null===Z||void 0===Z?void 0:Z.task[0]]:[],title:"Task ",action:fe,setAction:ge,access:Fe}),(null===Z||void 0===Z||null===(_=Z.task)||void 0===_?void 0:_.length)>1&&(0,T.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,T.jsx)(r.Button,{size:"sm",colorScheme:"brand",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>ve(!me),children:me?"Show less":"Show more"})})]})}),(null===Oe||void 0===Oe?void 0:Oe.view)&&(0,T.jsx)(a.GridItem,{colSpan:{base:12,md:6},children:(0,T.jsxs)(u.A,{overflow:"scroll",children:[(0,T.jsx)(H.A,{fetchData:Ge,columnsData:[{Header:"agenda",accessor:"agenda"},{Header:"date Time",accessor:"dateTime"},{Header:"times tamp",accessor:"timestamp"},{Header:"create By",accessor:"createdByName"}],tableData:xe?null===Z||void 0===Z?void 0:Z.meeting:(null===Z||void 0===Z||null===(V=Z.meeting)||void 0===V?void 0:V.length)>0?[null===Z||void 0===Z?void 0:Z.meeting[0]]:[],title:"Meeting ",action:fe,setAction:ge,access:Oe}),(0,T.jsx)(I.A,{fetchData:Ge,isOpen:ae,onClose:de,from:"contact",id:J.id,setAction:ge}),(null===Z||void 0===Z||null===(R=Z.meetingHistory)||void 0===R?void 0:R.length)>1&&(0,T.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,T.jsx)(r.Button,{colorScheme:"brand",size:"sm",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>he(!xe),children:xe?"Show less":"Show more"})})]})})]})})})}),(0,T.jsx)(d.Kp,{pt:4,p:0,children:(0,T.jsx)(a.GridItem,{colSpan:{base:4},children:(0,T.jsxs)(u.A,{minH:"50vh",children:[(0,T.jsxs)(a.Flex,{alignItems:"center",justifyContent:"space-between",mb:"2",children:[(0,T.jsx)(a.Heading,{size:"md",mb:3,children:"Documents"}),(0,T.jsx)(r.Button,{leftIcon:(0,T.jsx)(i.AddIcon,{}),size:"sm",variant:"brand",onClick:()=>pe(!0),children:"Add Document"})]}),(0,T.jsx)(F.A,{addDocument:je,setAddDocument:pe,linkId:J.id,from:"lead",setAction:ge}),(0,T.jsx)(m.E,{}),(0,T.jsx)(a.VStack,{mt:4,alignItems:"flex-start",children:(null===Z||void 0===Z||null===(W=Z.Document)||void 0===W?void 0:W.length)>0?null===Z||void 0===Z||null===(U=Z.Document)||void 0===U?void 0:U.map((e=>{var t;return(0,T.jsx)(c.A,{name:e.folderName,item:e,children:null===e||void 0===e||null===(t=e.files)||void 0===t?void 0:t.map((e=>(0,T.jsx)(c.A,{download:Te,data:e,name:e.fileName,isFile:!0,from:"lead"})))})})):(0,T.jsx)(a.Text,{textAlign:"center",width:"100%",color:M,fontSize:"sm",fontWeight:"700",children:(0,T.jsx)(B.A,{})})})]})})})]})]}),("superAdmin"===K.role||(null===we||void 0===we?void 0:we.update)||(null===we||void 0===we?void 0:we.delete))&&(0,T.jsx)(u.A,{mt:3,children:(0,T.jsx)(a.Grid,{templateColumns:"repeat(6, 1fr)",gap:1,children:(0,T.jsx)(a.GridItem,{colStart:6,children:(0,T.jsxs)(a.Flex,{justifyContent:"right",children:["superAdmin"===K.role||null!==we&&void 0!==we&&we.update?(0,T.jsx)(r.Button,{size:"sm",onClick:()=>te(!0),leftIcon:(0,T.jsx)(i.EditIcon,{}),mr:2.5,variant:"outline",colorScheme:"green",children:"Edit"}):"","superAdmin"===K.role||null!==we&&void 0!==we&&we.delete?(0,T.jsx)(r.Button,{size:"sm",style:{background:"red.800"},onClick:()=>ie(!0),leftIcon:(0,T.jsx)(i.DeleteIcon,{}),colorScheme:"red",children:"Delete"}):""]})})})})]})]})}}}]);
//# sourceMappingURL=563.b50a077c.chunk.js.map