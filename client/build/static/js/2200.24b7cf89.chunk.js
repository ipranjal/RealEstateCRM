"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[2200],{2545:(e,l,i)=>{i.r(l),i.d(l,{default:()=>xe});var o=i(4034),t=i(1206),n=i(9754),d=i(4450),s=i(8858),r=i(5376),a=i(2554),c=i(2892),v=i(9942),u=i(216),x=i(3994),p=i(9488),m=i(5043),h=i(4960),j=i(3216),g=i(5475),f=i(9621),y=i(8700),b=i(2943),S=i(3516),C=i(3458),I=i(1997),B=i(7149),z=i(579);function A(e){const{used:l,total:i,count:o,...n}=e,s=(0,t.dU)("secondaryGray.900","white"),r=(0,t.dU)("brand.500","white");return(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:2,children:[(0,z.jsx)(d.GridItem,{colSpan:{base:12},children:(0,z.jsx)(I.A,{w:{base:"100%"},me:"36px",minH:200,img:"Property Photos"===(null===e||void 0===e?void 0:e.text)?"img":"",height:"100%",onFileSelect:null===e||void 0===e?void 0:e.onFileSelect,content:(0,z.jsxs)(d.Box,{children:[(0,z.jsx)(C.In,{as:B.vpy,w:"80px",h:"80px",color:r}),(0,z.jsx)(d.Flex,{justify:"center",mx:"auto",mb:"12px",children:(0,z.jsx)(d.Text,{fontSize:"xl",fontWeight:"700",color:r,children:"Upload Files"})}),o>0&&(0,z.jsxs)(d.Text,{fontSize:"sm",fontWeight:"500",color:"secondaryGray.500",children:["Selected Files : ",o]})]})})}),(0,z.jsx)(d.GridItem,{colSpan:{base:12},children:(0,z.jsxs)(d.Flex,{direction:"column",children:[(0,z.jsxs)(d.Text,{color:s,fontWeight:"bold",textAlign:"start",fontSize:"2xl",mt:{base:"20px"},children:["Upload ",null===e||void 0===e?void 0:e.text]}),(0,z.jsx)(d.Text,{color:"gray.400",fontSize:"md",my:{base:"auto"},mx:"auto",textAlign:"start",children:"Accepted File Types (Images files - 15MB max) only 10 files"})]})})]})}const w=e=>{var l;const{onClose:i,isOpen:o,fetchData:t,text:n}=e,[s,r]=(0,m.useState)(!1),c=(0,S.Wx)({initialValues:{property:""},onSubmit:(e,l)=>{let{resetForm:i}=l;C(),i()}}),{errors:u,touched:x,values:h,handleBlur:j,handleChange:g,handleSubmit:y,setFieldValue:b}=c,C=async()=>{try{var l,o;r(!0);const d=new FormData;let s;null===h||void 0===h||null===(l=h.property)||void 0===l||l.forEach((e=>{null===d||void 0===d||d.append("property",e)})),"Property Photos"===n?s=await(0,f.d_)(`api/property/add-property-photos/${null===e||void 0===e?void 0:e.id}`,d):"Virtual Tours or Videos"===n?s=await(0,f.d_)(`api/property/add-virtual-tours-or-videos/${null===e||void 0===e?void 0:e.id}`,d):"Floor Plans"===n?s=await(0,f.d_)(`api/property/add-floor-plans/${null===e||void 0===e?void 0:e.id}`,d):"Property Documents"===n&&(s=await(0,f.d_)(`api/property/add-property-documents/${null===e||void 0===e?void 0:e.id}`,d)),200===(null===(o=s)||void 0===o?void 0:o.status)&&(t(1),c.resetForm(),i())}catch(d){console.log(d)}finally{r(!1)}};return(0,z.jsxs)(v.aF,{onClose:i,isOpen:o,isCentered:!0,children:[(0,z.jsx)(v.mH,{}),(0,z.jsxs)(v.$m,{children:[(0,z.jsxs)(v.rQ,{children:["Select ",n," "]}),(0,z.jsx)(v.s_,{}),(0,z.jsx)(v.cw,{children:(0,z.jsx)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsx)(A,{count:null===h||void 0===h||null===(l=h.property)||void 0===l?void 0:l.length,onFileSelect:e=>b("property",e),text:n}),(0,z.jsxs)(d.Text,{mb:"10px",color:"red",children:[" ",(null===u||void 0===u?void 0:u.property)&&(null===x||void 0===x?void 0:x.property)&&(0,z.jsxs)(z.Fragment,{children:["Please Select ",n]})]})]})})}),(0,z.jsxs)(v.jl,{children:[(0,z.jsx)(a.Button,{size:"sm",variant:"brand",onClick:y,mr:1,disabled:!!s,children:s?(0,z.jsx)(p.A,{}):"Save"}),(0,z.jsx)(a.Button,{size:"sm",colorScheme:"red",variant:"outline",onClick:()=>{i(),c.resetForm()},children:"Close"})]})]})]})};var D=i(5574),F=i(2853);const T=i.p+"static/media/xlsx.3b42e8cd4f9bf156c884.png",_=i.p+"static/media/jpg.fdaacb51b3eedae8f560.png",G=i.p+"static/media/png.591c905ba55daf938362.png",L=i.p+"static/media/pdf.218f27f51613b4b652ab.png",W=i.p+"static/media/xls.c0995978684211bf594e.png",N=i.p+"static/media/csv.42b148555d574a65e2e1.png",k=i.p+"static/media/file.cae13a973d5fc64cfbfe.png";var O=i(9702),V=i(8031),P=i(8177),E=i(7508),$=i(3915),H=i(850),q=(i(3288),i(5369)),R=i(74),Y=i.n(R),M=i(6178),U=i.n(M),Q=(i(6),i(9250),i(8510)),J=i(5104),K=i(4626),X=i(7682),Z=i(3186),ee=i(3388),le=i(446),ie=i.n(le),oe=i(2145),te=(i(9849),i(2101)),ne=i(4614),de=i(968),se=i(9565),re=i(1125),ae=i(8757),ce=i(899);const ve=e=>{var l,i;const{onClose:o,isOpen:t,fetchData:n}=e,s=JSON.parse(localStorage.getItem("user")),[r,c]=(0,m.useState)(!1),[u,x]=(0,m.useState)([]),[h,g]=(0,m.useState)([]),[y,b]=(0,m.useState)(!1),[C,I]=(0,m.useState)(!1),[B,A]=(0,m.useState)(!1),[w,D]=(0,m.useState)([]),F=null===(l=new Date)||void 0===l||null===(i=l.toISOString())||void 0===i?void 0:i.split(".")[0],[T,_]=(0,m.useState)([]),[G,L]=(0,m.useState)([]),[W,N]=(0,m.useState)(!1),k=(0,E.wA)(),{id:O}=(0,j.g)(),V={sender:null===s||void 0===s?void 0:s._id,recipient:!0!==e.lead?null===e||void 0===e?void 0:e.contactEmail:null===e||void 0===e?void 0:e.leadEmail,subject:"",message:"",createByContact:null!==e&&void 0!==e&&e.id&&!0!==(null===e||void 0===e?void 0:e.lead)?null===e||void 0===e?void 0:e.id:"",createByLead:null!==e&&void 0!==e&&e.id&&!0===(null===e||void 0===e?void 0:e.lead)?null===e||void 0===e?void 0:e.id:"",startDate:"",property:[O],type:"message",html:"",createBy:null===s||void 0===s?void 0:s._id,salesAgent:""},P=ce.object({sender:ce.string().required("Sender Is required"),recipient:ce.string().email().required("Recipient Is required"),cc:ce.string().email(),bcc:ce.string().email(),relatedToContact:ce.string(),property:ce.array().required("property is required"),relatedToLead:ce.string(),subject:ce.string().required("Subject Is required"),message:ce.string(),startDate:ce.date().required("Start Date Is required"),createBy:ce.string(),createByLead:ce.string(),salesAgent:ce.string().required("Assign To Sales Agent Is required")}),$=(0,S.Wx)({initialValues:V,validationSchema:P,enableReinitialize:!0,onSubmit:(e,l)=>{let{resetForm:i}=l;ve(),i()}}),{errors:H,touched:q,values:R,handleBlur:Y,handleChange:M,handleSubmit:U,setFieldValue:le}=$,ve=async()=>{try{c(!0),200===(await(0,f.d_)("api/email/add",R)).status&&(e.onClose(),n(1))}catch(l){console.log(l)}finally{c(!1)}};(0,m.useEffect)((()=>{(async()=>{if(null!==R&&void 0!==R&&R.createByContact){let e=h.find((e=>(null===e||void 0===e?void 0:e._id)===(null===R||void 0===R?void 0:R.createByContact)));e&&le("recipient",null===e||void 0===e?void 0:e.email)}else if(null!==R&&void 0!==R&&R.createByLead){let e=null===u||void 0===u?void 0:u.find((e=>(null===e||void 0===e?void 0:e._id)===(null===R||void 0===R?void 0:R.createByLead)));e&&le("recipient",null===e||void 0===e?void 0:e.leadEmail)}else le("recipient","")})()}),[null===R||void 0===R?void 0:R.createByContact,null===R||void 0===R?void 0:R.createByLead]);(0,m.useEffect)((()=>{(async()=>{R.start=null===e||void 0===e?void 0:e.date;try{let e;var l;if("Contact"===(null===R||void 0===R?void 0:R.category)&&(null===h||void 0===h?void 0:h.length)<=0)e=await(0,f.x4)("superAdmin"===(null===s||void 0===s?void 0:s.role)?"api/contact/":`api/contact/?createBy=${null===s||void 0===s?void 0:s._id}`),g(null===(l=e)||void 0===l?void 0:l.data);else if("Lead"===(null===R||void 0===R?void 0:R.category)&&u<=0){var i;e=await(0,f.x4)("superAdmin"===(null===s||void 0===s?void 0:s.role)?"api/lead/":`api/lead/?createBy=${null===s||void 0===s?void 0:s._id}`),x(null===(i=e)||void 0===i?void 0:i.data)}const o=await(0,f.x4)("superAdmin"===(null===s||void 0===s?void 0:s.role)?"api/property":`api/property/?createBy=${null===s||void 0===s?void 0:s._id}`);D(null===o||void 0===o?void 0:o.data)}catch(o){console.log(o)}})()}),[e,null===R||void 0===R?void 0:R.category]);(0,m.useEffect)((()=>{"template"===(null===R||void 0===R?void 0:R.type)&&(async()=>{var e;c(!0);const l=await k((0,te.t)());var i;200===(null===l||void 0===l||null===(e=l.payload)||void 0===e?void 0:e.status)?_(null===l||void 0===l||null===(i=l.payload)||void 0===i?void 0:i.data):oe.oR.error("Failed to fetch data","error"),c(!1)})()}),[null===R||void 0===R?void 0:R.type]),(0,m.useEffect)((()=>{(async()=>{c(!0);try{var e,l;let i=await(0,f.x4)("api/user/"),o=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(l=e.user)||void 0===l?void 0:l.filter((e=>{var l;return null===e||void 0===e||null===(l=e.roles)||void 0===l?void 0:l.some((e=>"Sales"===(null===e||void 0===e?void 0:e.roleName)))})))||[];L(o)}catch(i){console.error("Failed to fetch users data:",i)}finally{c(!1)}})()}),[]);const ue=null===w||void 0===w?void 0:w.map((e=>({...e,value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})));return(0,z.jsxs)(v.aF,{onClose:o,isOpen:t,isCentered:!0,children:[(0,z.jsx)(v.mH,{}),(0,z.jsxs)(v.$m,{height:"580px",children:[(0,z.jsx)(v.rQ,{children:"Add Email"}),(0,z.jsx)(v.s_,{}),(0,z.jsxs)(v.cw,{overflowY:"auto",height:"400px",children:[(0,z.jsx)(se.A,{isOpen:y,data:h,onClose:b,fieldName:"createByContact",setFieldValue:le}),(0,z.jsx)(re.A,{isOpen:C,data:u,onClose:I,fieldName:"createByLead",setFieldValue:le}),(0,z.jsx)(ne.A,{onClose:()=>N(!1),isOpen:W,fieldName:"salesAgent",setFieldValue:le,data:G,isLoding:r,setIsLoding:c}),(0,z.jsx)(ae.A,{onClose:()=>A(!1),isOpen:B,data:w,isLoding:r,setIsLoding:c,fieldName:"property",setFieldValue:le,selectedItems:null===ue||void 0===ue?void 0:ue.filter((e=>{var l;return null===R||void 0===R||null===(l=R.property)||void 0===l?void 0:l.includes(null===e||void 0===e?void 0:e._id)}))}),(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Related"}),(0,z.jsx)(J.z6,{onChange:e=>{le("category",e),le("createByContact",""),le("createByLead","")},value:R.category,children:(0,z.jsxs)(d.Stack,{direction:"row",children:[(0,z.jsx)(J.sx,{value:"Contact",children:"Contact"}),(0,z.jsx)(J.sx,{value:"Lead",children:"Lead"})]})})]}),(0,z.jsx)(d.GridItem,{colSpan:{base:12},children:"Contact"===R.category?(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Contact)"}),(0,z.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,z.jsx)(K.l6,{value:R.createByContact,name:"createByContact",onChange:M,mb:H.createByContact&&q.createByContact?void 0:"10px",fontWeight:"500",placeholder:"Assign To",borderColor:H.createByContact&&q.createByContact?"red.300":null,children:null===h||void 0===h?void 0:h.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:"Contact"===R.category?`${null===e||void 0===e?void 0:e.fullName}`:null===e||void 0===e?void 0:e.leadName},null===e||void 0===e?void 0:e._id)))}),(0,z.jsx)(a.IconButton,{onClick:()=>b(!0),ml:2,fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]})]})}):"Lead"===(null===R||void 0===R?void 0:R.category)?(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Lead)"}),(0,z.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,z.jsx)(K.l6,{value:null===R||void 0===R?void 0:R.createByLead,name:"createByLead",onChange:M,mb:null!==H&&void 0!==H&&H.createByLead&&null!==q&&void 0!==q&&q.createByLead?void 0:"10px",fontWeight:"500",placeholder:"Assign To",borderColor:null!==H&&void 0!==H&&H.createByLead&&null!==q&&void 0!==q&&q.createByLead?"red.300":null,children:null===u||void 0===u?void 0:u.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:"Contact"===R.category?`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`:null===e||void 0===e?void 0:e.leadName},null===e||void 0===e?void 0:e._id)))}),(0,z.jsx)(a.IconButton,{onClick:()=>I(!0),ml:2,fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]})]})}):""}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Recipient",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsx)(X.Input,{fontSize:"sm",disabled:!0,value:R.recipient,name:"recipient",placeholder:"Recipient",fontWeight:"500",borderColor:null!==H&&void 0!==H&&H.recipient&&null!==q&&void 0!==q&&q.recipient?"red.300":null}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===H||void 0===H?void 0:H.recipient)&&(null===q||void 0===q?void 0:q.recipient)&&(null===H||void 0===H?void 0:H.recipient)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(d.Flex,{alignItems:"end",justifyContent:"space-between",children:[(0,z.jsx)(d.Text,{w:"100%",children:(0,z.jsx)(de.CUIAutoComplete,{label:"Property",items:ue,selectedItems:null===ue||void 0===ue?void 0:ue.filter((e=>{var l;return null===R||void 0===R||null===(l=R.property)||void 0===l?void 0:l.includes(e._id)})),onSelectedItemsChange:e=>{const l=null===(i=e.selectedItems)||void 0===i?void 0:i.map((e=>null===e||void 0===e?void 0:e._id));var i;le("property",l)},value:(null===w||void 0===w?void 0:w.name)||R.property,name:"property",onChange:M,mb:null!==H&&void 0!==H&&H.property&&null!==q&&void 0!==q&&q.property?void 0:"10px",fontWeight:"500",placeholder:"Assign To Property",borderColor:null!==H&&void 0!==H&&H.property&&null!==q&&void 0!==q&&q.property?"red.300":null})}),(0,z.jsx)(a.IconButton,{mb:6,onClick:()=>A(!0),fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]}),(0,z.jsxs)(d.Text,{color:"red",children:[" ",(null===H||void 0===H?void 0:H.attendes)&&(null===q||void 0===q?void 0:q.attendes)&&(null===H||void 0===H?void 0:H.attendes)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Start Date",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsx)(X.Input,{type:"datetime-local",fontSize:"sm",onChange:M,onBlur:Y,min:ie()(F).format("YYYY-MM-DD HH:mm"),value:R.startDate,name:"startDate",fontWeight:"500",borderColor:null!==H&&void 0!==H&&H.startDate&&null!==q&&void 0!==q&&q.startDate?"red.300":null}),(0,z.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===H||void 0===H?void 0:H.startDate)&&(null===q||void 0===q?void 0:q.startDate)&&(null===H||void 0===H?void 0:H.startDate)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Assign To Sales Agent ",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,z.jsx)(K.l6,{value:null===R||void 0===R?void 0:R.salesAgent,name:"salesAgent",onChange:M,mb:null!==H&&void 0!==H&&H.salesAgent&&null!==q&&void 0!==q&&q.salesAgent?void 0:"10px",fontWeight:"500",placeholder:"Assign To Sales Agent",borderColor:null!==H&&void 0!==H&&H.salesAgent&&null!==q&&void 0!==q&&q.salesAgent?"red.300":null,children:null===G||void 0===G?void 0:G.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`},null===e||void 0===e?void 0:e._id)))}),(0,z.jsx)(a.IconButton,{onClick:()=>N(!0),ml:2,fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]}),(0,z.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===H||void 0===H?void 0:H.salesAgent)&&(null===q||void 0===q?void 0:q.salesAgent)&&(null===H||void 0===H?void 0:H.salesAgent)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Subject",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsx)(X.Input,{fontSize:"sm",onChange:M,onBlur:Y,value:null===R||void 0===R?void 0:R.subject,name:"subject",placeholder:"subject",fontWeight:"500",borderColor:null!==H&&void 0!==H&&H.subject&&null!==q&&void 0!==q&&q.subject?"red.300":null}),(0,z.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===H||void 0===H?void 0:H.subject)&&(null===q||void 0===q?void 0:q.subject)&&(null===H||void 0===H?void 0:H.subject)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Message"}),(0,z.jsx)(J.z6,{onChange:e=>{le("type",e)},value:null===R||void 0===R?void 0:R.type,children:(0,z.jsxs)(d.Stack,{direction:"row",children:[(0,z.jsx)(J.sx,{value:"message",children:"Message"}),(0,z.jsx)(J.sx,{value:"template",children:"Template"})]})})]}),(0,z.jsx)(d.GridItem,{colSpan:{base:12},children:"message"===(null===R||void 0===R?void 0:R.type)?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Z.T,{resize:"none",fontSize:"sm",placeholder:"Enter Message",onChange:M,onBlur:Y,value:R.message,name:"message",fontWeight:"500",borderColor:null!==H&&void 0!==H&&H.message&&null!==q&&void 0!==q&&q.message?"red.300":null}),(0,z.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===H||void 0===H?void 0:H.message)&&(null===q||void 0===q?void 0:q.message)&&(null===H||void 0===H?void 0:H.message)]})]}):(0,z.jsx)(K.l6,{name:"html",onChange:M,onBlur:Y,value:null===R||void 0===R?void 0:R.html,fontWeight:"500",placeholder:"Select Template",children:null===T||void 0===T?void 0:T.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e.html,children:null===e||void 0===e?void 0:e.templateName},e._id)))})})]})]}),(0,z.jsxs)(v.jl,{children:[(0,z.jsx)(a.Button,{variant:"brand",size:"sm",disabled:!!r,onClick:U,children:r?(0,z.jsx)(p.A,{}):"Save"}),(0,z.jsx)(a.Button,{sx:{marginLeft:2,textTransform:"capitalize"},variant:"outline",colorScheme:"red",onClick:()=>{$.resetForm(),o()},size:"sm",children:"Close"})]})]})]})};i(1716);const ue=e=>{const{onClose:l,isOpen:i,setAction:o,fetchData:t}=e,[n,s]=(0,m.useState)(!1),[r,c]=(0,m.useState)([]),[u,x]=(0,m.useState)([]),[h,g]=(0,m.useState)(!1),[y,b]=(0,m.useState)(!1),[C,I]=(0,m.useState)(!1),[B,A]=(0,m.useState)([]),[w,D]=(0,m.useState)([]),[F,T]=(0,m.useState)(!1),_=JSON.parse(localStorage.getItem("user")),G=(new Date).toISOString().split(".")[0],{id:L}=(0,j.g)(),W={sender:null===_||void 0===_?void 0:_._id,recipient:"",callDuration:"",callNotes:"",createByContact:"",createByLead:"",property:[L],startDate:"",category:"contact",createBy:null===_||void 0===_?void 0:_._id,salesAgent:""},N=ce.object({sender:ce.string().required("Sender Is required"),recipient:ce.string().required("Recipient Is required"),callDuration:ce.string().required("Call Duration is required"),property:ce.array().required("property is required"),callNotes:ce.string(),createBy:ce.string(),createByLead:ce.string(),category:ce.string(),startDate:ce.date().required("Start Date Is required"),salesAgent:ce.string().required("Assign To Sales Agent Is required")}),k=(0,S.Wx)({initialValues:W,validationSchema:N,enableReinitialize:!0,onSubmit:(e,l)=>{let{resetForm:i}=l;R(),i()}}),{errors:O,touched:V,values:P,handleBlur:E,handleChange:$,handleSubmit:H,setFieldValue:q}=k,R=async()=>{try{s(!0);let l=await(0,f.d_)("api/phoneCall/add",P);200===(null===l||void 0===l?void 0:l.status)&&(e.onClose(),t(1),o((e=>!e)))}catch(l){console.log(l)}finally{s(!1)}};(0,m.useEffect)((()=>{(async()=>{P.start=null===e||void 0===e?void 0:e.date;try{let e;var l;if("Contact"===(null===P||void 0===P?void 0:P.category)&&(null===u||void 0===u?void 0:u.length)<=0)e=await(0,f.x4)("superAdmin"===(null===_||void 0===_?void 0:_.role)?"api/contact/":`api/contact/?createBy=${null===_||void 0===_?void 0:_._id}`),x(null===(l=e)||void 0===l?void 0:l.data);else if("Lead"===(null===P||void 0===P?void 0:P.category)&&(null===r||void 0===r?void 0:r.length)<=0){var i;e=await(0,f.x4)("superAdmin"===(null===_||void 0===_?void 0:_.role)?"api/lead/":`api/lead/?createBy=${null===_||void 0===_?void 0:_._id}`),c(null===(i=e)||void 0===i?void 0:i.data)}const o=await(0,f.x4)("superAdmin"===(null===_||void 0===_?void 0:_.role)?"api/property":`api/property/?createBy=${null===_||void 0===_?void 0:_._id}`);A(null===o||void 0===o?void 0:o.data)}catch(o){console.log(o)}})()}),[null===e||void 0===e?void 0:e.date,null===P||void 0===P?void 0:P.category]);(0,m.useEffect)((()=>{(async()=>{if(null!==P&&void 0!==P&&P.createByContact){let e=null===u||void 0===u?void 0:u.find((e=>(null===e||void 0===e?void 0:e._id)===(null===P||void 0===P?void 0:P.createByContact)));e&&q("recipient",null===e||void 0===e?void 0:e.phoneNumber)}else if(null!==P&&void 0!==P&&P.createByLead){let e=r.find((e=>(null===e||void 0===e?void 0:e._id)===(null===P||void 0===P?void 0:P.createByLead)));e&&q("recipient",null===e||void 0===e?void 0:e.leadPhoneNumber)}else q("recipient","")})()}),[null===P||void 0===P?void 0:P.createByContact,null===P||void 0===P?void 0:P.createByLead]),(0,m.useEffect)((()=>{(async()=>{s(!0);try{var e,l;let i=await(0,f.x4)("api/user/"),o=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(l=e.user)||void 0===l?void 0:l.filter((e=>{var l;return null===e||void 0===e||null===(l=e.roles)||void 0===l?void 0:l.some((e=>"Sales"===(null===e||void 0===e?void 0:e.roleName)))})))||[];D(o)}catch(i){console.error("Failed to fetch users data:",i)}finally{s(!1)}})()}),[]);const Y=null===B||void 0===B?void 0:B.map((e=>({...e,value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})));return(0,z.jsxs)(v.aF,{onClose:l,isOpen:i,isCentered:!0,children:[(0,z.jsx)(v.mH,{}),(0,z.jsxs)(v.$m,{children:[(0,z.jsx)(v.rQ,{children:"Add Call"}),(0,z.jsx)(v.s_,{}),(0,z.jsxs)(v.cw,{children:[(0,z.jsx)(se.A,{isOpen:h,data:u,onClose:g,fieldName:"createByContact",setFieldValue:q}),(0,z.jsx)(re.A,{isOpen:y,data:r,onClose:b,fieldName:"createByLead",setFieldValue:q}),(0,z.jsx)(ne.A,{onClose:()=>T(!1),isOpen:F,fieldName:"salesAgent",setFieldValue:q,data:w,isLoding:n,setIsLoding:s}),(0,z.jsx)(ae.A,{onClose:()=>I(!1),isOpen:C,data:B,isLoding:n,setIsLoding:s,fieldName:"property",setFieldValue:q,selectedItems:null===Y||void 0===Y?void 0:Y.filter((e=>{var l;return null===P||void 0===P||null===(l=P.property)||void 0===l?void 0:l.includes(null===e||void 0===e?void 0:e._id)}))}),(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Related"}),(0,z.jsx)(J.z6,{onChange:e=>{q("category",e),q("createByContact",""),q("createByLead","")},value:null===P||void 0===P?void 0:P.category,children:(0,z.jsxs)(d.Stack,{direction:"row",children:[(0,z.jsx)(J.sx,{value:"Contact",children:"Contact"}),(0,z.jsx)(J.sx,{value:"Lead",children:"Lead"})]})}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===O||void 0===O?void 0:O.category)&&(null===V||void 0===V?void 0:V.category)&&(null===O||void 0===O?void 0:O.category)]})]}),(0,z.jsx)(d.GridItem,{colSpan:{base:12},children:"Contact"===(null===P||void 0===P?void 0:P.category)?(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Contact)"}),(0,z.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,z.jsx)(K.l6,{value:null===P||void 0===P?void 0:P.createByContact,name:"createByContact",onChange:$,mb:null!==O&&void 0!==O&&O.createByContact&&null!==V&&void 0!==V&&V.createByContact?void 0:"10px",fontWeight:"500",placeholder:"Assign To",borderColor:null!==O&&void 0!==O&&O.createByContact&&null!==V&&void 0!==V&&V.createByContact?"red.300":null,children:null===u||void 0===u?void 0:u.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:"Contact"===(null===P||void 0===P?void 0:P.category)?`${null===e||void 0===e?void 0:e.fullName}`:null===e||void 0===e?void 0:e.leadName},null===e||void 0===e?void 0:e._id)))}),(0,z.jsx)(a.IconButton,{onClick:()=>g(!0),ml:2,fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===O||void 0===O?void 0:O.createByContact)&&(null===V||void 0===V?void 0:V.createByContact)&&(null===O||void 0===O?void 0:O.createByContact)]})]})}):"Lead"===(null===P||void 0===P?void 0:P.category)?(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Recipient (Lead)"}),(0,z.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,z.jsx)(K.l6,{value:null===P||void 0===P?void 0:P.createByLead,name:"createByLead",onChange:$,mb:null!==O&&void 0!==O&&O.createByLead&&null!==V&&void 0!==V&&V.createByLead?void 0:"10px",fontWeight:"500",placeholder:"Assign To",borderColor:null!==O&&void 0!==O&&O.createByLead&&null!==V&&void 0!==V&&V.createByLead?"red.300":null,children:null===r||void 0===r?void 0:r.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:"Contact"===(null===P||void 0===P?void 0:P.category)?`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`:null===e||void 0===e?void 0:e.leadName},null===e||void 0===e?void 0:e._id)))}),(0,z.jsx)(a.IconButton,{onClick:()=>b(!0),ml:2,fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===O||void 0===O?void 0:O.createByLead)&&(null===V||void 0===V?void 0:V.createByLead)&&(null===O||void 0===O?void 0:O.createByLead)]})]})}):""}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Recipient",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsx)(X.Input,{fontSize:"sm",disabled:!0,value:null!==P&&void 0!==P&&P.recipient?null===P||void 0===P?void 0:P.recipient:"",name:"recipient",placeholder:"Recipient",fontWeight:"500",borderColor:null!==O&&void 0!==O&&O.recipient&&null!==V&&void 0!==V&&V.recipient?"red.300":null})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(d.Flex,{alignItems:"end",justifyContent:"space-between",children:[(0,z.jsx)(d.Text,{w:"100%",children:(0,z.jsx)(de.CUIAutoComplete,{label:"Property",items:Y,selectedItems:null===Y||void 0===Y?void 0:Y.filter((e=>{var l;return null===P||void 0===P||null===(l=P.property)||void 0===l?void 0:l.includes(null===e||void 0===e?void 0:e._id)})),onSelectedItemsChange:e=>{const l=null===(i=null===e||void 0===e?void 0:e.selectedItems)||void 0===i?void 0:i.map((e=>null===e||void 0===e?void 0:e._id));var i;q("property",l)},name:"property",onChange:$,mb:null!==O&&void 0!==O&&O.property&&null!==V&&void 0!==V&&V.property?void 0:"10px",fontWeight:"500",placeholder:"Assign To Property",borderColor:null!==O&&void 0!==O&&O.property&&null!==V&&void 0!==V&&V.property?"red.300":null})}),(0,z.jsx)(a.IconButton,{mb:6,onClick:()=>I(!0),fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]}),(0,z.jsxs)(d.Text,{color:"red",children:[" ",(null===O||void 0===O?void 0:O.attendes)&&(null===V||void 0===V?void 0:V.attendes)&&(null===O||void 0===O?void 0:O.attendes)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Start Date",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsx)(X.Input,{type:"datetime-local",fontSize:"sm",onChange:$,onBlur:E,min:ie()(G).format("YYYY-MM-DD HH:mm"),value:null===P||void 0===P?void 0:P.startDate,name:"startDate",fontWeight:"500",borderColor:null!==O&&void 0!==O&&O.startDate&&null!==V&&void 0!==V&&V.startDate?"red.300":null}),(0,z.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===O||void 0===O?void 0:O.startDate)&&(null===V||void 0===V?void 0:V.startDate)&&(null===O||void 0===O?void 0:O.startDate)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12,md:6},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Call Duration",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsx)(X.Input,{fontSize:"sm",onChange:$,onBlur:E,value:null===P||void 0===P?void 0:P.callDuration,name:"callDuration",placeholder:"call Duration",fontWeight:"500",borderColor:null!==O&&void 0!==O&&O.callDuration&&null!==V&&void 0!==V&&V.callDuration?"red.300":null}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===O||void 0===O?void 0:O.callDuration)&&(null===V||void 0===V?void 0:V.callDuration)&&(null===O||void 0===O?void 0:O.callDuration)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsxs)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Assign To Sales Agent ",(0,z.jsx)(d.Text,{color:"red",children:"*"})]}),(0,z.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,z.jsx)(K.l6,{value:null===P||void 0===P?void 0:P.salesAgent,name:"salesAgent",onChange:$,mb:null!==O&&void 0!==O&&O.salesAgent&&null!==V&&void 0!==V&&V.salesAgent?void 0:"10px",fontWeight:"500",placeholder:"Assign To Sales Agent",borderColor:null!==O&&void 0!==O&&O.salesAgent&&null!==V&&void 0!==V&&V.salesAgent?"red.300":null,children:null===w||void 0===w?void 0:w.map((e=>(0,z.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`},null===e||void 0===e?void 0:e._id)))}),(0,z.jsx)(a.IconButton,{onClick:()=>T(!0),ml:2,fontSize:"25px",icon:(0,z.jsx)(ee.G2h,{})})]}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===O||void 0===O?void 0:O.salesAgent)&&(null===V||void 0===V?void 0:V.salesAgent)&&(null===O||void 0===O?void 0:O.salesAgent)]})]}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsx)(Q.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Call Notes"}),(0,z.jsx)(Z.T,{resize:"none",fontSize:"sm",placeholder:"Enter Call Notes",onChange:$,onBlur:E,value:null===P||void 0===P?void 0:P.callNotes,name:"callNotes",fontWeight:"500",borderColor:null!==O&&void 0!==O&&O.callNotes&&null!==V&&void 0!==V&&V.callNotes?"red.300":null}),(0,z.jsxs)(d.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===O||void 0===O?void 0:O.callNotes)&&(null===V||void 0===V?void 0:V.callNotes)&&(null===O||void 0===O?void 0:O.callNotes)]})]})]})]}),(0,z.jsxs)(v.jl,{children:[(0,z.jsx)(a.Button,{variant:"brand",size:"sm",disabled:!!n,onClick:H,children:n?(0,z.jsx)(p.A,{}):"Save"}),(0,z.jsx)(a.Button,{size:"sm",sx:{marginLeft:2,textTransform:"capitalize"},variant:"outline",colorScheme:"red",onClick:()=>{k.resetForm(),l()},children:"Close"})]})]})]})},xe=()=>{var e,l,i,S,C,I,B,A,R,M,Q,J,K,X,Z,ee,le,ie,oe,te,ne,de,se,re,ae,ce,xe,pe,me,he;const je=JSON.parse(localStorage.getItem("user")),ge=(0,j.g)(),fe=((0,t.dU)("gray.200","white"),(0,t.dU)("gray.500","white")),[ye,be]=(0,m.useState)(),[Se,Ce]=(0,m.useState)([]),{isOpen:Ie,onOpen:Be,onClose:ze}=(0,n.j1)(),[Ae,we]=(0,m.useState)(!1),[De,Fe]=(0,m.useState)(!1),[Te,_e]=(0,m.useState)(!1),[Ge,Le]=(0,m.useState)(!1),[We,Ne]=(0,m.useState)(!1),[ke,Oe]=(0,m.useState)(!1),[Ve,Pe]=(0,m.useState)(!1),[Ee,$e]=(0,m.useState)(!1),[He,qe]=(0,m.useState)(),[Re,Ye]=(0,m.useState)(!1),[Me,Ue]=(0,m.useState)([]),[Qe,Je]=(0,m.useState)(!1),[Ke,Xe]=(0,m.useState)(!1),[Ze,el]=(0,m.useState)(!1),[ll,il]=(0,m.useState)(0),[ol,tl]=(0,m.useState)(!1),[nl,dl]=(0,m.useState)(!1),[sl,rl]=(0,m.useState)([]),[al,cl]=(0,m.useState)([]),vl=(0,E.wA)(),ul=(0,E.d4)((e=>{var l,i;return null===e||void 0===e||null===(l=e.propertyCustomFiled)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.data})),[xl,pl]=(0,m.useState)([]),[ml,hl]=(0,m.useState)([]),[jl,gl]=(0,m.useState)(!1),fl=(0,j.Zp)(),[yl,bl,Sl,Cl,Il]=(0,D.h)(["Leads","Tasks","Meetings","Properties","Calls","Emails","Tasks","Meetings"]),Bl=[{Header:"sender",accessor:"senderName"},{Header:"recipient",accessor:"recipient",cell:e=>{var l,i;return(0,z.jsx)(g.N_,{to:`/Email/${null===e||void 0===e||null===(l=e.row)||void 0===l||null===(i=l.original)||void 0===i?void 0:i._id}`,children:(0,z.jsx)(d.Text,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||" - "})})}},{Header:"time stamp",accessor:"timestamp",cell:e=>(0,z.jsx)("div",{className:"selectOpt",children:(0,z.jsx)(d.Text,{color:fe,fontSize:"sm",fontWeight:"700",children:U()(null===e||void 0===e?void 0:e.value).fromNow()})})},{Header:"Created",accessor:"createBy",cell:e=>{var l,i,o;return(0,z.jsx)("div",{className:"selectOpt",children:(0,z.jsx)(d.Text,{color:fe,fontSize:"sm",fontWeight:"700",children:null===(l=U()(null===e||void 0===e||null===(i=e.row)||void 0===i||null===(o=i.values)||void 0===o?void 0:o.timestamp))||void 0===l?void 0:l.format("h:mma (DD/MM)")})})}}],zl=[{Header:"sender",accessor:"senderName"},{Header:"recipient",accessor:"recipient",cell:e=>{var l,i;return(0,z.jsx)(g.N_,{to:`/phone-call/${null===e||void 0===e||null===(l=e.row)||void 0===l||null===(i=l.original)||void 0===i?void 0:i._id}`,children:(0,z.jsx)(d.Text,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||" - "})})}},{Header:"time stamp",accessor:"timestamp",cell:e=>(0,z.jsx)("div",{className:"selectOpt",children:(0,z.jsx)(d.Text,{color:fe,fontSize:"sm",fontWeight:"700",children:U()(null===e||void 0===e?void 0:e.value).fromNow()})})},{Header:"Created",accessor:"createBy",cell:e=>{var l,i,o;return(0,z.jsx)("div",{className:"selectOpt",children:(0,z.jsx)(d.Text,{color:fe,fontSize:"sm",fontWeight:"700",children:null===(l=U()(null===e||void 0===e||null===(i=e.row)||void 0===i||null===(o=i.values)||void 0===o?void 0:o.timestamp))||void 0===l?void 0:l.format("h:mma (DD/MM)")})})}}],[Al,wl]=(0,m.useState)([...ml]),Dl=async e=>{var l,i,o,t;Xe(!0);let n=await(0,f.x4)("api/property/view/",null===ge||void 0===ge?void 0:ge.id);be(null===n||void 0===n||null===(l=n.data)||void 0===l?void 0:l.property),rl(null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.phoneCall),cl(null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.Emails),Ce(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.filteredContacts),Xe(!1),il(e)};(0,m.useEffect)((()=>{vl((0,$.R)()),Dl(),(async()=>{var e,l,i,o,t,n;Xe(!0);const d=await vl((0,H.I)());pl(null===d||void 0===d||null===(e=d.payload)||void 0===e?void 0:e.data);const s=[{Header:"#",accessor:"_id",isSortable:!1,width:10},...null===d||void 0===d||null===(l=d.payload)||void 0===l||null===(i=l.data)||void 0===i||null===(o=i[0])||void 0===o||null===(t=o.fields)||void 0===t||null===(n=t.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||void 0===n?void 0:n.map((e=>({Header:null===e||void 0===e?void 0:e.label,accessor:null===e||void 0===e?void 0:e.name})))];hl(s),Xe(!1)})()}),[]);const[Fl,Tl,_l]=(0,D.h)(["Properties","Contacts","Emails","Calls"]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(y.A,{isOpen:Ie,size:"lg",onClose:ze,propertyData:null===ul||void 0===ul?void 0:ul[0]}),(0,z.jsx)(b.A,{isOpen:Ae,size:"lg",onClose:we,setAction:_e,propertyData:null===ul||void 0===ul?void 0:ul[0],data:ye}),(0,z.jsx)(P.A,{isOpen:De,onClose:()=>Fe(!1),type:"Property",handleDeleteData:async e=>{try{Xe(!0);let l=await(0,f.Gx)("api/property/delete/",e);200===(null===l||void 0===l?void 0:l.status)&&(Fe(!1),_e((e=>!e)),fl("/properties"))}catch(l){console.log(l)}finally{Xe(!1)}},ids:null===ge||void 0===ge?void 0:ge.id}),(0,z.jsx)(ve,{lead:!0,leadEmail:null===Me||void 0===Me||null===(e=Me.lead)||void 0===e?void 0:e.leadEmail,fetchData:Dl,isOpen:ol,onClose:tl,id:null===ge||void 0===ge?void 0:ge.id}),(0,z.jsx)(ue,{viewData:Me,fetchData:Dl,isOpen:nl,onClose:dl,setAction:_e,data:null===ye||void 0===ye?void 0:ye.contact,id:null===ge||void 0===ge?void 0:ge.id,lead:!0,LData:ye}),Ke?(0,z.jsx)(d.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,z.jsx)(p.A,{})}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(d.Heading,{size:"lg",mt:0,m:3,children:(null===ye||void 0===ye?void 0:ye.name)||""}),(0,z.jsxs)(s.tU,{onChange:e=>{il(e)},index:ll,children:[(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",mb:3,gap:1,children:[(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsxs)(s.wb,{sx:{border:"none","& button:focus":{boxShadow:"none"},"& button":{margin:{sm:"0 3px",md:"0 5px"},padding:{sm:"5px",md:"8px"},border:"2px solid #8080803d",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",borderBottom:0,fontSize:{sm:"12px",md:"16px"}},'& button[aria-selected="true"]':{border:"2px solid brand.200",borderBottom:0,zIndex:"0"}},children:[(0,z.jsx)(s.oz,{children:"Information"}),((null===Tl||void 0===Tl?void 0:Tl.view)||(null===_l||void 0===_l?void 0:_l.view))&&(0,z.jsx)(s.oz,{children:"Communication"}),(0,z.jsx)(s.oz,{children:"Gallery"})]})}),(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},mt:{sm:"3px",md:"5px"},children:(0,z.jsxs)(d.Flex,{justifyContent:"right",children:[(0,z.jsxs)(r.W1,{children:[("superAdmin"===(null===je||void 0===je?void 0:je.role)||(null===Fl||void 0===Fl?void 0:Fl.create)||(null===Fl||void 0===Fl?void 0:Fl.update)||(null===Fl||void 0===Fl?void 0:Fl.delete))&&(0,z.jsx)(r.IU,{variant:"outline",size:"sm",colorScheme:"blackAlpha",va:!0,mr:2.5,as:a.Button,rightIcon:(0,z.jsx)(o.ChevronDownIcon,{}),children:"Actions"}),(0,z.jsx)(r.Nj,{}),(0,z.jsxs)(r.cO,{minWidth:2,children:[("superAdmin"===(null===je||void 0===je?void 0:je.role)||(null===Fl||void 0===Fl?void 0:Fl.create))&&(0,z.jsx)(r.Dr,{alignItems:"start",color:"blue",onClick:()=>Be(),icon:(0,z.jsx)(o.AddIcon,{}),children:"Add"}),("superAdmin"===(null===je||void 0===je?void 0:je.role)||(null===Fl||void 0===Fl?void 0:Fl.update))&&(0,z.jsx)(r.Dr,{alignItems:"start",onClick:()=>we(!0),icon:(0,z.jsx)(o.EditIcon,{}),children:"Edit"}),(0,z.jsx)(r.Dr,{onClick:()=>{const e=document.getElementById("reports");e?(e.style.display="block",e.style.width="100%",e.style.height="auto",Y()().from(e).set({margin:[0,0,0,0],filename:`Property_Details_${U()().format("DD-MM-YYYY")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}}).save().then((()=>{e.style.display=""}))):console.error("Element with ID 'reports' not found.")},alignItems:"start",icon:(0,z.jsx)(q.kl1,{}),display:"flex",style:{alignItems:"center"},children:"Print as PDF"}),("superAdmin"===(null===je||void 0===je?void 0:je.role)||(null===Fl||void 0===Fl?void 0:Fl.delete))&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r.Nj,{}),(0,z.jsx)(r.Dr,{alignItems:"start",color:"red",onClick:()=>Fe(!0),icon:(0,z.jsx)(o.DeleteIcon,{}),children:"Delete"})]})]})]}),(0,z.jsx)(g.N_,{to:"/properties",children:(0,z.jsx)(a.Button,{size:"sm",leftIcon:(0,z.jsx)(h.m6W,{}),variant:"brand",children:"Back"})})]})})]}),(0,z.jsxs)(s.T2,{children:[(0,z.jsxs)(s.Kp,{pt:4,p:0,children:[(0,z.jsx)(O.A,{data:null===ul||void 0===ul?void 0:ul[0],fieldData:ye,fetchData:Dl,editUrl:`api/property/edit/${ge.id}`,moduleId:null===ul||void 0===ul||null===(l=ul[0])||void 0===l?void 0:l._id,id:"reports"}),(null===Se||void 0===Se?void 0:Se.length)>0&&(0,z.jsx)(d.GridItem,{colSpan:{base:12},mt:4,children:(0,z.jsx)(d.Grid,{templateColumns:{base:"1fr"},children:(0,z.jsx)(d.GridItem,{colSpan:2,children:(0,z.jsx)(d.Grid,{templateColumns:"repeat(2, 1fr)",children:(0,z.jsx)(d.GridItem,{colSpan:{base:2},children:(0,z.jsx)(V.A,{AdvanceSearch:!1,ManageGrid:!1,access:!1,columnData:null!==ml&&void 0!==ml?ml:[],title:"Interested Contact",allData:null!==Se&&void 0!==Se?Se:[],tableData:Se,size:"md",tableCustomFields:(null===xl||void 0===xl||null===(i=xl[0])||void 0===i||null===(S=i.fields)||void 0===S?void 0:S.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||[],customSearch:!0,checkBox:!1})})})})})})]}),(0,z.jsx)(s.Kp,{pt:4,p:0,children:(0,z.jsx)(d.GridItem,{colSpan:{base:4},children:(0,z.jsx)(d.Grid,{overflow:"hidden",templateColumns:{base:"1fr"},gap:4,children:(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(null===Tl||void 0===Tl?void 0:Tl.view)&&(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsx)(u.A,{children:(0,z.jsx)(V.A,{title:"Email",isLoding:Ke,columnData:null!==Bl&&void 0!==Bl?Bl:[],allData:al,tableData:al,AdvanceSearch:!1,dataLength:null===Me||void 0===Me||null===(C=Me.Email)||void 0===C?void 0:C.length,tableCustomFields:[],checkBox:!1,deleteMany:!0,ManageGrid:!1,onOpen:()=>tl(!0),access:Tl})})}),(null===_l||void 0===_l?void 0:_l.view)&&(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsx)(u.A,{children:(0,z.jsx)(V.A,{title:"Call",isLoding:Ke,columnData:null!==zl&&void 0!==zl?zl:[],allData:sl,tableData:sl,AdvanceSearch:!1,dataLength:null===Me||void 0===Me||null===(I=Me.phoneCall)||void 0===I?void 0:I.length,tableCustomFields:[],checkBox:!1,deleteMany:!0,ManageGrid:!1,onOpen:()=>dl(!0),access:_l})})})]})})})}),(0,z.jsx)(s.Kp,{pt:4,p:0,children:(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsx)(u.A,{children:(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(0,z.jsx)(d.GridItem,{colSpan:12,children:(0,z.jsxs)(d.Box,{children:[(0,z.jsxs)(d.Flex,{flexWrap:"wrap",mb:3,justifyContent:"space-between",alingItem:"center",children:[(0,z.jsx)(d.Heading,{size:"md",children:"Property Photos"}),(0,z.jsx)(a.Button,{size:"sm",leftIcon:(0,z.jsx)(o.AddIcon,{}),onClick:()=>Le(!0),variant:"brand",children:"Add New"}),(0,z.jsx)(w,{text:"Property Photos",fetchData:Dl,isOpen:Ge,onClose:Le,id:null===ge||void 0===ge?void 0:ge.id})]}),(0,z.jsx)(x.E,{})]})}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsx)(d.Flex,{overflowY:"scroll",height:"150px",alingItem:"center",children:(null===ye||void 0===ye||null===(B=ye.propertyPhotos)||void 0===B?void 0:B.length)>0?ye&&(null===ye||void 0===ye||null===(A=ye.propertyPhotos)||void 0===A?void 0:A.length)>0&&(null===ye||void 0===ye||null===(R=ye.propertyPhotos)||void 0===R?void 0:R.map((e=>(0,z.jsx)(c._V,{width:"150px",m:1,src:null===e||void 0===e?void 0:e.img,alt:"Your Image"})))):(0,z.jsx)(d.Text,{textAlign:"center",width:"100%",color:fe,fontSize:"sm",fontWeight:"700",children:(0,z.jsx)(F.A,{})})}),(null===ye||void 0===ye||null===(M=ye.propertyPhotos)||void 0===M?void 0:M.length)>0?(0,z.jsx)(d.Flex,{justifyContent:"end",mt:1,children:(0,z.jsx)(a.Button,{size:"sm",colorScheme:"brand",variant:"outline",onClick:()=>{el(!0),gl("photo")},children:"Show more"})}):""]})]})})}),(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsx)(u.A,{children:(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(0,z.jsx)(d.GridItem,{colSpan:12,children:(0,z.jsxs)(d.Box,{children:[(0,z.jsxs)(d.Flex,{flexWrap:"wrap",mb:3,justifyContent:"space-between",alingItem:"center",children:[(0,z.jsx)(d.Heading,{size:"md",children:"Virtual Tours or Videos"}),(0,z.jsx)(a.Button,{size:"sm",leftIcon:(0,z.jsx)(o.AddIcon,{}),onClick:()=>Oe(!0),variant:"brand",children:"Add New"}),(0,z.jsx)(w,{text:"Virtual Tours or Videos",fetchData:Dl,isOpen:ke,onClose:Oe,id:null===ge||void 0===ge?void 0:ge.id})]}),(0,z.jsx)(x.E,{})]})}),(0,z.jsx)(d.GridItem,{colSpan:{base:12},children:(0,z.jsx)(d.Flex,{overflowY:"scroll",height:"150px",alingItem:"center",children:(null===ye||void 0===ye||null===(Q=ye.virtualToursOrVideos)||void 0===Q?void 0:Q.length)>0?ye&&(null===ye||void 0===ye||null===(J=ye.virtualToursOrVideos)||void 0===J?void 0:J.length)>0&&(null===ye||void 0===ye||null===(K=ye.virtualToursOrVideos)||void 0===K?void 0:K.map((e=>(0,z.jsxs)("video",{width:"200",controls:!0,autoplay:!0,loop:!0,style:{margin:"0 5px"},children:[(0,z.jsx)("source",{src:null===e||void 0===e?void 0:e.img,type:"video/mp4"}),(0,z.jsx)("source",{src:null===e||void 0===e?void 0:e.img,type:"video/ogg"})]})))):(0,z.jsx)(d.Text,{textAlign:"center",width:"100%",color:fe,fontSize:"sm",fontWeight:"700",children:(0,z.jsx)(F.A,{})})})})]})})}),(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsx)(u.A,{children:(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(0,z.jsx)(d.GridItem,{colSpan:12,children:(0,z.jsxs)(d.Box,{children:[(0,z.jsxs)(d.Flex,{flexWrap:"wrap",mb:3,justifyContent:"space-between",alingItem:"center",children:[(0,z.jsx)(d.Heading,{size:"md",children:"Floor Plans"}),(0,z.jsx)(a.Button,{size:"sm",leftIcon:(0,z.jsx)(o.AddIcon,{}),onClick:()=>Pe(!0),variant:"brand",children:"Add New"}),(0,z.jsx)(w,{text:"Floor Plans",fetchData:Dl,isOpen:Ve,onClose:Pe,id:ge.id})]}),(0,z.jsx)(x.E,{})]})}),(0,z.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,z.jsx)(d.Flex,{overflowY:"scroll",height:"150px",alingItem:"center",children:(null===ye||void 0===ye||null===(X=ye.floorPlans)||void 0===X?void 0:X.length)>0?ye&&(null===ye||void 0===ye||null===(Z=ye.floorPlans)||void 0===Z?void 0:Z.length)>0&&(null===ye||void 0===ye||null===(ee=ye.floorPlans)||void 0===ee?void 0:ee.map((e=>(0,z.jsx)(c._V,{width:"30%",m:1,src:null===e||void 0===e?void 0:e.img,alt:"Your Image"},null===e||void 0===e?void 0:e.createOn)))):(0,z.jsx)(d.Text,{textAlign:"center",width:"100%",color:fe,fontSize:"sm",fontWeight:"700",children:(0,z.jsx)(F.A,{})})}),(null===ye||void 0===ye||null===(le=ye.floorPlans)||void 0===le?void 0:le.length)>0?(0,z.jsx)(d.Flex,{justifyContent:"end",mt:1,children:(0,z.jsx)(a.Button,{size:"sm",colorScheme:"brand",variant:"outline",onClick:()=>{el(!0),gl("floor")},children:"Show more"})}):""]})]})})}),(0,z.jsx)(d.GridItem,{colSpan:{base:12,md:6},children:(0,z.jsxs)(u.A,{children:[(0,z.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(0,z.jsx)(d.GridItem,{colSpan:12,children:(0,z.jsxs)(d.Box,{children:[(0,z.jsxs)(d.Flex,{flexWrap:"wrap",mb:3,justifyContent:"space-between",alingItem:"center",children:[(0,z.jsx)(d.Heading,{size:"md",children:"Property Documents"}),(0,z.jsx)(a.Button,{size:"sm",variant:"brand",leftIcon:(0,z.jsx)(o.AddIcon,{}),onClick:()=>$e(!0),children:"Add New"}),(0,z.jsx)(w,{text:"Property Documents",fetchData:Dl,isOpen:Ee,onClose:$e,id:null===ge||void 0===ge?void 0:ge.id})]}),(0,z.jsx)(x.E,{})]})}),(0,z.jsx)(d.GridItem,{colSpan:12,sx:{maxHeight:"200px",overflowX:"auto"},children:(null===ye||void 0===ye||null===(ie=ye.propertyDocuments)||void 0===ie?void 0:ie.length)>0?ye&&(null===ye||void 0===ye||null===(oe=ye.propertyDocuments)||void 0===oe?void 0:oe.length)>0&&(null===ye||void 0===ye||null===(te=ye.propertyDocuments)||void 0===te?void 0:te.map((e=>{var l;const i=null===e||void 0===e||null===(l=e.filename)||void 0===l?void 0:l.split("."),o=i[(null===i||void 0===i?void 0:i.length)-1];return(0,z.jsxs)(d.Flex,{alignItems:"center",mt:"3",children:["xlsx"===o&&(0,z.jsx)(c._V,{src:T,boxSize:"50px"}),"jpg"===o&&(0,z.jsx)(c._V,{src:_,boxSize:"50px"}),"png"===o&&(0,z.jsx)(c._V,{src:G,boxSize:"50px"}),"pdf"===o&&(0,z.jsx)(c._V,{src:L,boxSize:"50px"}),"xls"===o&&(0,z.jsx)(c._V,{src:W,boxSize:"50px"}),"csv"===o&&(0,z.jsx)(c._V,{src:N,boxSize:"50px"}),!("xls"===o||"csv"===o||"png"===o||"pdf"===o||"xlsx"===o||"jpg"===o)&&(0,z.jsx)(c._V,{src:k,boxSize:"50px"}),(0,z.jsx)(d.Text,{ml:2,color:"green.400",onClick:()=>{var l;return null===(l=window)||void 0===l?void 0:l.open(null===e||void 0===e?void 0:e.img)},cursor:"pointer",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},children:e.filename})]})}))):(0,z.jsx)(d.Text,{textAlign:"center",width:"100%",color:fe,fontSize:"sm",fontWeight:"700",children:(0,z.jsx)(F.A,{})})})]}),(null===ye||void 0===ye||null===(ne=ye.propertyDocuments)||void 0===ne?void 0:ne.length)>0?(0,z.jsx)(d.Flex,{justifyContent:"end",mt:1,children:(0,z.jsx)(a.Button,{size:"sm",colorScheme:"brand",variant:"outline",onClick:()=>{Ne(!0),gl("Doucument")},children:"Show more"})}):""]})})]})})]})]}),((null===Fl||void 0===Fl?void 0:Fl.delete)||(null===Fl||void 0===Fl?void 0:Fl.update)||"superAdmin"===(null===je||void 0===je?void 0:je.role))&&(0,z.jsx)(u.A,{mt:3,children:(0,z.jsx)(d.Grid,{templateColumns:"repeat(6, 1fr)",gap:1,children:(0,z.jsx)(d.GridItem,{colStart:6,children:(0,z.jsxs)(d.Flex,{justifyContent:"right",children:[(null===Fl||void 0===Fl?void 0:Fl.update)&&(0,z.jsx)(a.Button,{onClick:()=>we(!0),size:"sm",leftIcon:(0,z.jsx)(o.EditIcon,{}),mr:2.5,variant:"outline",colorScheme:"green",children:"Edit"}),(null===Fl||void 0===Fl?void 0:Fl.delete)&&(0,z.jsx)(a.Button,{style:{background:"red.800"},size:"sm",onClick:()=>Fe(!0),leftIcon:(0,z.jsx)(o.DeleteIcon,{}),colorScheme:"red",children:"Delete"})]})})})})]}),(0,z.jsxs)(v.aF,{onClose:()=>el(!1),isOpen:Ze,children:[(0,z.jsx)(v.mH,{}),(0,z.jsxs)(v.$m,{maxWidth:"6xl",height:"750px",children:[(0,z.jsx)(v.rQ,{children:"photo"===jl?"Property All Photos":"video"===jl?"Virtual Tours or Videos":"floor"===jl?"Floors plans":""}),(0,z.jsx)(v.s_,{onClick:()=>el(!1)}),(0,z.jsx)(v.cw,{overflowY:"auto",height:"700px",children:(0,z.jsx)("div",{style:{columns:3},children:"photo"===jl?ye&&(null===ye||void 0===ye||null===(de=ye.propertyPhotos)||void 0===de?void 0:de.length)>0&&(null===ye||void 0===ye||null===(se=ye.propertyPhotos)||void 0===se?void 0:se.map((e=>(0,z.jsxs)("a",{href:null===e||void 0===e?void 0:e.img,target:"_blank",children:[" ",(0,z.jsx)(c._V,{width:"100%",m:1,mb:4,src:null===e||void 0===e?void 0:e.img,alt:"Your Image"})]})))):"video"===jl?ye&&(null===ye||void 0===ye||null===(re=ye.virtualToursOrVideos)||void 0===re?void 0:re.length)>0&&(null===ye||void 0===ye||null===(ae=ye.virtualToursOrVideos)||void 0===ae?void 0:ae.map((e=>(0,z.jsx)("a",{href:null===e||void 0===e?void 0:e.img,target:"_blank",children:(0,z.jsxs)("video",{width:"380",controls:!0,autoplay:!0,loop:!0,style:{margin:" 5px"},children:[(0,z.jsx)("source",{src:null===e||void 0===e?void 0:e.img,type:"video/mp4"}),(0,z.jsx)("source",{src:null===e||void 0===e?void 0:e.img,type:"video/ogg"})]})})))):"floor"===jl?ye&&(null===ye||void 0===ye||null===(ce=ye.floorPlans)||void 0===ce?void 0:ce.length)>0&&(null===ye||void 0===ye||null===(xe=ye.floorPlans)||void 0===xe?void 0:xe.map((e=>(0,z.jsx)("a",{href:e.img,target:"_blank",children:(0,z.jsx)(c._V,{width:"100%",m:1,mb:4,src:e.img,alt:"Your Image"})})))):""})}),(0,z.jsx)(v.jl,{children:(0,z.jsx)(a.Button,{size:"sm",variant:"outline",colorScheme:"red",mr:2,onClick:()=>el(!1),children:"Close"})})]})]}),(0,z.jsxs)(v.aF,{onClose:()=>Ne(!1),isOpen:We,children:[(0,z.jsx)(v.mH,{}),(0,z.jsxs)(v.$m,{maxWidth:"xl",height:"750px",children:[(0,z.jsx)(v.rQ,{children:"Property All Document"}),(0,z.jsx)(v.s_,{onClick:()=>Ne(!1)}),(0,z.jsx)(v.cw,{overflowY:"auto",height:"700px",children:(null===ye||void 0===ye||null===(pe=ye.propertyDocuments)||void 0===pe?void 0:pe.length)>0?ye&&(null===ye||void 0===ye||null===(me=ye.propertyDocuments)||void 0===me?void 0:me.length)>0&&(null===ye||void 0===ye||null===(he=ye.propertyDocuments)||void 0===he?void 0:he.map((e=>{var l;const i=null===e||void 0===e||null===(l=e.filename)||void 0===l?void 0:l.split("."),o=i[(null===i||void 0===i?void 0:i.length)-1];return(0,z.jsxs)(d.Flex,{alignItems:"center",mt:"3",children:["xlsx"===o&&(0,z.jsx)(c._V,{src:T,boxSize:"50px"}),"jpg"===o&&(0,z.jsx)(c._V,{src:_,boxSize:"50px"}),"png"===o&&(0,z.jsx)(c._V,{src:G,boxSize:"50px"}),"pdf"===o&&(0,z.jsx)(c._V,{src:L,boxSize:"50px"}),"xls"===o&&(0,z.jsx)(c._V,{src:W,boxSize:"50px"}),"csv"===o&&(0,z.jsx)(c._V,{src:N,boxSize:"50px"}),!("xls"===o||"csv"===o||"png"===o||"pdf"===o||"xlsx"===o||"jpg"===o)&&(0,z.jsx)(c._V,{src:k,boxSize:"50px"}),(0,z.jsx)(d.Text,{ml:2,color:"green.400",onClick:()=>window.open(null===e||void 0===e?void 0:e.img),cursor:"pointer",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},children:null===e||void 0===e?void 0:e.filename})]})}))):(0,z.jsx)(d.Text,{textAlign:"center",width:"100%",color:fe,fontSize:"sm",fontWeight:"700",children:(0,z.jsx)(F.A,{})})}),(0,z.jsx)(v.jl,{children:(0,z.jsx)(a.Button,{size:"sm",variant:"outline",colorScheme:"red",mr:2,onClick:()=>Ne(!1),children:"Close"})})]})]})]})}},2943:(e,l,i)=>{i.d(l,{A:()=>h});var o=i(4034),t=i(9942),n=i(2554),d=i(4450),s=i(9488),r=i(3516),a=i(5043),c=i(3216),v=i(9621),u=i(2030),x=i(8908),p=i(899),m=i(579);const h=e=>{var l,i,h,j,g;const{data:f}=e,y=null===Object||void 0===Object?void 0:Object.fromEntries(null===(l=(null===e||void 0===e||null===(i=e.leadData)||void 0===i?void 0:i.fields)||[])||void 0===l?void 0:l.map((e=>[null===e||void 0===e?void 0:e.name,""]))),[b,S]=(0,a.useState)({...y,createBy:null===(h=JSON.parse(localStorage.getItem("user")))||void 0===h?void 0:h._id}),C=(0,c.g)(),I=(0,r.Wx)({initialValues:b,validationSchema:null===(j=p.object())||void 0===j?void 0:j.shape((0,u.g)(null===e||void 0===e||null===(g=e.propertyData)||void 0===g?void 0:g.fields)),enableReinitialize:!0,onSubmit:(e,l)=>{let{resetForm:i}=l;L()}}),{errors:B,touched:z,values:A,handleBlur:w,handleChange:D,handleSubmit:F,setFieldValue:T}=I,[_,G]=(0,a.useState)(!1),L=async()=>{try{G(!0);let l=await(0,v.yP)(`api/property/edit/${(null===e||void 0===e?void 0:e.selectedId)||(null===C||void 0===C?void 0:C.id)}`,A);200===(null===l||void 0===l?void 0:l.status)&&(e.onClose(),e.setAction((e=>!e)))}catch(l){console.log(l)}finally{G(!1)}};let W;return(0,a.useEffect)((()=>{(async()=>{if(f)S((e=>({...e,...f})));else if(null!==e&&void 0!==e&&e.selectedId)try{G(!0),W=await(0,v.x4)("api/property/view/",null===e||void 0===e?void 0:e.selectedId),S((e=>{var l,i;return{...e,...null===(l=W)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.property}}))}catch(l){console.error(l)}finally{G(!1)}})()}),[null===e||void 0===e?void 0:e.selectedId,f]),(0,m.jsx)("div",{children:(0,m.jsxs)(t._s,{isOpen:null===e||void 0===e?void 0:e.isOpen,size:null===e||void 0===e?void 0:e.size,children:[(0,m.jsx)(t.QP,{}),(0,m.jsxs)(t.zj,{children:[(0,m.jsxs)(t.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Edit ",(null===A||void 0===A?void 0:A.name)||"Property",(0,m.jsx)(n.IconButton,{onClick:()=>{e.onClose(!1),e.setSelectedId&&(null===e||void 0===e||e.setSelectedId())},icon:(0,m.jsx)(o.CloseIcon,{})})]}),(0,m.jsx)(t.ys,{children:_?(0,m.jsx)(d.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,m.jsx)(s.A,{})}):(0,m.jsx)(x.A,{moduleData:null===e||void 0===e?void 0:e.propertyData,values:A,setFieldValue:T,handleChange:D,handleBlur:w,errors:B,touched:z})}),(0,m.jsxs)(t.tb,{children:[(0,m.jsx)(n.Button,{size:"sm",sx:{textTransform:"capitalize"},variant:"brand",disabled:!!_,type:"submit",onClick:F,children:_?(0,m.jsx)(s.A,{}):"Update"}),(0,m.jsx)(n.Button,{size:"sm",variant:"outline",colorScheme:"red",sx:{marginLeft:2,textTransform:"capitalize"},onClick:()=>{null===e||void 0===e||e.onClose(!1)},children:"Close"})]})]})]})})}},8700:(e,l,i)=>{i.d(l,{A:()=>p});var o=i(4034),t=i(9942),n=i(2554),d=i(9488),s=i(3516),r=i(5043),a=i(9621),c=i(2030),v=i(8908),u=i(899),x=i(579);const p=e=>{var l,i,p,m;const[h,j]=(0,r.useState)(!1),g={...null===Object||void 0===Object?void 0:Object.fromEntries(null===(l=(null===e||void 0===e||null===(i=e.propertyData)||void 0===i?void 0:i.fields)||[])||void 0===l?void 0:l.map((e=>[null===e||void 0===e?void 0:e.name,""]))),createBy:JSON.parse(localStorage.getItem("user"))._id},f=(0,s.Wx)({initialValues:g,enableReinitialize:!0,validationSchema:null===(p=u.object())||void 0===p?void 0:p.shape((0,c.g)(null===e||void 0===e||null===(m=e.propertyData)||void 0===m?void 0:m.fields)),onSubmit:(e,l)=>{let{resetForm:i}=l;A()}}),{errors:y,touched:b,values:S,handleBlur:C,handleChange:I,handleSubmit:B,setFieldValue:z}=f,A=async()=>{try{var l;j(!0);let i=await(0,a.d_)("api/form/add",{...S,moduleId:null===e||void 0===e||null===(l=e.propertyData)||void 0===l?void 0:l._id});200===(null===i||void 0===i?void 0:i.status)&&(e.onClose(),f.resetForm(),e.setAction((e=>!e)))}catch(i){console.log(i)}finally{j(!1)}};return(0,x.jsx)("div",{children:(0,x.jsxs)(t._s,{isOpen:null===e||void 0===e?void 0:e.isOpen,size:null===e||void 0===e?void 0:e.size,children:[(0,x.jsx)(t.QP,{}),(0,x.jsxs)(t.zj,{children:[(0,x.jsxs)(t.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Add Property",(0,x.jsx)(n.IconButton,{onClick:null===e||void 0===e?void 0:e.onClose,icon:(0,x.jsx)(o.CloseIcon,{})})]}),(0,x.jsx)(t.ys,{children:(0,x.jsx)(v.A,{moduleData:null===e||void 0===e?void 0:e.propertyData,values:S,setFieldValue:z,handleChange:I,handleBlur:C,errors:y,touched:b})}),(0,x.jsxs)(t.tb,{children:[(0,x.jsx)(n.Button,{size:"sm",sx:{textTransform:"capitalize"},disabled:!!h,variant:"brand",type:"submit",onClick:B,children:h?(0,x.jsx)(d.A,{}):"Save"}),(0,x.jsx)(n.Button,{size:"sm",variant:"outline",colorScheme:"red",sx:{marginLeft:2,textTransform:"capitalize"},onClick:null===e||void 0===e?void 0:e.onClose,children:"Close"})]})]})]})})}}}]);
//# sourceMappingURL=2200.24b7cf89.chunk.js.map