"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[4891],{6:(e,l,i)=>{i.d(l,{A:()=>A});var n=i(9942),o=i(4450),s=i(8510),t=i(7682),d=i(4626),a=i(2554),r=i(5104),c=i(3186),u=i(3388),v=i(9488),m=i(446),x=i.n(m),h=i(3516),p=i(5043),j=i(7508),g=i(2145),f=i(9849),b=i(9621),S=i(2101),C=i(4614),y=i(579);const A=e=>{var l,i;const{onClose:m,isOpen:A,fetchData:D,setAction:z}=e,F=JSON.parse(localStorage.getItem("user")),[I,T]=(0,p.useState)(!1),B=null===(l=new Date)||void 0===l||null===(i=l.toISOString())||void 0===i?void 0:i.split(".")[0],[L,N]=(0,p.useState)([]),[W,w]=(0,p.useState)([]),[_,G]=(0,p.useState)(!1),k=(0,j.wA)(),H={sender:null===F||void 0===F?void 0:F._id,recipient:!0!==(null===e||void 0===e?void 0:e.lead)?null===e||void 0===e?void 0:e.contactEmail:null===e||void 0===e?void 0:e.leadEmail,subject:"",message:"",createByContact:null!==e&&void 0!==e&&e.id&&!0!==(null===e||void 0===e?void 0:e.lead)?null===e||void 0===e?void 0:e.id:"",createByLead:null!==e&&void 0!==e&&e.id&&!0===(null===e||void 0===e?void 0:e.lead)?null===e||void 0===e?void 0:e.id:"",startDate:"",type:"message",html:"",createBy:null===F||void 0===F?void 0:F._id,salesAgent:""},O=(0,h.Wx)({initialValues:H,validationSchema:f.y4,enableReinitialize:!0,onSubmit:(e,l)=>{let{resetForm:i}=l;J(),i()}}),{errors:M,touched:V,values:Y,handleBlur:E,handleChange:$,handleSubmit:R,setFieldValue:Q}=O,J=async()=>{try{T(!0);let l=await(0,b.d_)("api/email/add",Y);200===(null===l||void 0===l?void 0:l.status)&&(null===e||void 0===e||e.onClose(),D(1))}catch(l){console.log(l)}finally{T(!1)}};return(0,p.useEffect)((()=>{"template"===(null===Y||void 0===Y?void 0:Y.type)&&(async()=>{var e;T(!0);const l=await k((0,S.t)());var i;200===(null===l||void 0===l||null===(e=l.payload)||void 0===e?void 0:e.status)?N(null===l||void 0===l||null===(i=l.payload)||void 0===i?void 0:i.data):g.oR.error("Failed to fetch data","error"),T(!1)})()}),[null===Y||void 0===Y?void 0:Y.type]),(0,p.useEffect)((()=>{(async()=>{T(!0);try{var e,l;let i=await(0,b.x4)("api/user/"),n=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(l=e.user)||void 0===l?void 0:l.filter((e=>{var l;return null===e||void 0===e||null===(l=e.roles)||void 0===l?void 0:l.some((e=>"Sales"===(null===e||void 0===e?void 0:e.roleName)))})))||[];w(n)}catch(i){console.error("Failed to fetch users data:",i)}finally{T(!1)}})()}),[]),(0,y.jsxs)(n.aF,{onClose:m,isOpen:A,isCentered:!0,children:[(0,y.jsx)(n.mH,{}),(0,y.jsxs)(n.$m,{children:[(0,y.jsx)(n.rQ,{children:"Send Email "}),(0,y.jsx)(n.s_,{}),(0,y.jsxs)(n.cw,{children:[(0,y.jsx)(C.A,{onClose:()=>G(!1),isOpen:_,fieldName:"salesAgent",setFieldValue:Q,data:W,isLoding:I,setIsLoding:T}),(0,y.jsxs)(o.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,y.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,y.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Recipient",(0,y.jsx)(o.Text,{color:"red",children:"*"})]}),(0,y.jsx)(t.Input,{fontSize:"sm",onChange:$,onBlur:E,value:null===Y||void 0===Y?void 0:Y.recipient,name:"recipient",disabled:!0,placeholder:"Recipient",fontWeight:"500",borderColor:null!==M&&void 0!==M&&M.recipient&&null!==V&&void 0!==V&&V.recipient?"red.300":null}),(0,y.jsxs)(o.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===M||void 0===M?void 0:M.recipient)&&(null===V||void 0===V?void 0:V.recipient)&&(null===M||void 0===M?void 0:M.recipient)]})]}),(0,y.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,y.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Subject",(0,y.jsx)(o.Text,{color:"red",children:"*"})]}),(0,y.jsx)(t.Input,{fontSize:"sm",placeholder:"Enter subject",onChange:$,onBlur:E,value:null===Y||void 0===Y?void 0:Y.subject,name:"subject",fontWeight:"500",borderColor:null!==M&&void 0!==M&&M.subject&&null!==V&&void 0!==V&&V.subject?"red.300":null}),(0,y.jsxs)(o.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===M||void 0===M?void 0:M.subject)&&(null===V||void 0===V?void 0:V.subject)&&(null===M||void 0===M?void 0:M.subject)]})]}),(0,y.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,y.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Start Date",(0,y.jsx)(o.Text,{color:"red",children:"*"})]}),(0,y.jsx)(t.Input,{type:"datetime-local",fontSize:"sm",onChange:$,onBlur:E,min:x()(B).format("YYYY-MM-DD HH:mm"),value:null===Y||void 0===Y?void 0:Y.startDate,name:"startDate",fontWeight:"500",borderColor:null!==M&&void 0!==M&&M.startDate&&null!==V&&void 0!==V&&V.startDate?"red.300":null}),(0,y.jsxs)(o.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===M||void 0===M?void 0:M.startDate)&&(null===V||void 0===V?void 0:V.startDate)&&(null===M||void 0===M?void 0:M.startDate)]})]}),(0,y.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,y.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Assign To Sales Agent",(0,y.jsx)(o.Text,{color:"red",children:"*"})]}),(0,y.jsxs)(o.Flex,{justifyContent:"space-between",children:[(0,y.jsx)(d.l6,{value:null===Y||void 0===Y?void 0:Y.salesAgent,name:"salesAgent",onChange:$,mb:null!==M&&void 0!==M&&M.salesAgent&&null!==V&&void 0!==V&&V.salesAgent?void 0:"10px",fontWeight:"500",placeholder:"Assign To Sales Agent",borderColor:null!==M&&void 0!==M&&M.salesAgent&&null!==V&&void 0!==V&&V.salesAgent?"red.300":null,children:null===W||void 0===W?void 0:W.map((e=>(0,y.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`},null===e||void 0===e?void 0:e._id)))}),(0,y.jsx)(a.IconButton,{onClick:()=>G(!0),ml:2,fontSize:"25px",icon:(0,y.jsx)(u.G2h,{})})]}),(0,y.jsxs)(o.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===M||void 0===M?void 0:M.salesAgent)&&(null===V||void 0===V?void 0:V.salesAgent)&&(null===M||void 0===M?void 0:M.salesAgent)]})]}),(0,y.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,y.jsx)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Message"}),(0,y.jsx)(r.z6,{onChange:e=>{Q("type",e)},value:null===Y||void 0===Y?void 0:Y.type,children:(0,y.jsxs)(o.Stack,{direction:"row",children:[(0,y.jsx)(r.sx,{value:"message",children:"Message"}),(0,y.jsx)(r.sx,{value:"template",children:"Template"})]})})]}),(0,y.jsx)(o.GridItem,{colSpan:{base:12},children:"message"===(null===Y||void 0===Y?void 0:Y.type)?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.T,{resize:"none",fontSize:"sm",placeholder:"Enter Message",onChange:$,onBlur:E,value:null===Y||void 0===Y?void 0:Y.message,name:"message",fontWeight:"500",borderColor:null!==M&&void 0!==M&&M.message&&null!==V&&void 0!==V&&V.message?"red.300":null}),(0,y.jsxs)(o.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===M||void 0===M?void 0:M.message)&&(null===V||void 0===V?void 0:V.message)&&(null===M||void 0===M?void 0:M.message)]})]}):(0,y.jsx)(d.l6,{name:"html",onChange:$,onBlur:E,value:null===Y||void 0===Y?void 0:Y.html,fontWeight:"500",placeholder:"Select Template",children:null===L||void 0===L?void 0:L.map((e=>(0,y.jsx)("option",{value:null===e||void 0===e?void 0:e.html,children:null===e||void 0===e?void 0:e.templateName},e._id)))})})]})]}),(0,y.jsxs)(n.jl,{children:[(0,y.jsx)(a.Button,{size:"sm",variant:"brand",onClick:R,disabled:!!I,children:I?(0,y.jsx)(v.A,{}):"Save"}),(0,y.jsx)(a.Button,{sx:{marginLeft:2,textTransform:"capitalize"},variant:"outline",colorScheme:"red",size:"sm",onClick:()=>{O.resetForm(),m()},children:"Close"})]})]})]})}},4614:(e,l,i)=>{i.d(l,{A:()=>v});var n=i(9942),o=i(4450),s=i(2554),t=i(5043),d=i(9488),a=i(8860),r=i(8031),c=(i(7892),i(7508)),u=(i(9621),i(579));const v=e=>{const{onClose:l,isOpen:i,fieldName:v,setFieldValue:m,data:x,isLoding:h,setIsLoding:p}=e,[j,g]=((0,c.wA)(),(0,t.useState)([])),[f,b]=(0,t.useState)([]),S=[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"email Id",accessor:"username"},{Header:"first Name",accessor:"firstName"},{Header:"last Name",accessor:"lastName"},..."salesAgent"!==v?[{Header:"role",accessor:"role"}]:[]];return(0,u.jsxs)(n.aF,{onClose:l,size:"full",isOpen:i,children:[(0,u.jsx)(n.mH,{}),(0,u.jsxs)(n.$m,{children:[(0,u.jsx)(n.rQ,{children:"Select User"}),(0,u.jsx)(n.s_,{}),(0,u.jsx)(n.cw,{children:h?(0,u.jsx)(o.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,u.jsx)(d.A,{})}):(0,u.jsx)(r.A,{title:"Users",isLoding:h,columnData:null!==S&&void 0!==S?S:[],allData:null!==x&&void 0!==x?x:[],tableData:x,AdvanceSearch:()=>"",ManageGrid:!1,deleteMany:!1,selectedValues:f,setSelectedValues:b,selectType:"single",customSearch:!1})}),(0,u.jsxs)(n.jl,{children:[(0,u.jsxs)(s.Button,{variant:"brand",size:"sm",me:2,disabled:!!h,leftIcon:(0,u.jsx)(a.NLY,{}),onClick:async()=>{try{p(!0),m(v,f),l()}catch(e){console.log(e)}finally{p(!1)}},children:[" ",h?(0,u.jsx)(d.A,{}):"Select"]}),(0,u.jsx)(s.Button,{variant:"outline",size:"sm",colorScheme:"red",onClick:()=>l(),children:"Close"})]})]})]})}},9250:(e,l,i)=>{i.d(l,{A:()=>f});var n=i(9942),o=i(4450),s=i(8510),t=i(7682),d=i(4626),a=i(2554),r=i(3388),c=i(9488),u=i(446),v=i.n(u),m=i(3516),x=i(5043),h=i(9849),p=i(9621),j=i(4614),g=i(579);const f=e=>{const{onClose:l,isOpen:i,viewData:u,fetchData:f,setAction:b,cData:S,LData:C}=e,[y,A]=(0,x.useState)(!1),D=(new Date).toISOString().split(".")[0],z=JSON.parse(localStorage.getItem("user")),[F,I]=(0,x.useState)([]),[T,B]=(0,x.useState)(!1),L={sender:null===z||void 0===z?void 0:z._id,recipient:"",callDuration:"",callNotes:"",createByContact:"",createByLead:"",startDate:"",createBy:null===z||void 0===z?void 0:z._id,salesAgent:""},N=(0,m.Wx)({initialValues:L,validationSchema:h.Ar,onSubmit:(e,l)=>{let{resetForm:i}=l;M(),i()}}),{errors:W,touched:w,values:_,handleBlur:G,handleChange:k,handleSubmit:H,setFieldValue:O}=N,M=async()=>{try{A(!0);let l=await(0,p.d_)("api/phoneCall/add",_);200===(null===l||void 0===l?void 0:l.status)&&(null===e||void 0===e||e.onClose(),f(1))}catch(l){console.log(l)}finally{A(!1)}};return(0,x.useEffect)((()=>{(async()=>{var l,i;C&&null!==C&&void 0!==C&&C._id&&!0===(null===e||void 0===e?void 0:e.lead)?(O("recipient",(null===C||void 0===C?void 0:C.leadPhoneNumber)||(null===u||void 0===u||null===(l=u.lead)||void 0===l?void 0:l.leadMobile)),O("createByLead",null===e||void 0===e?void 0:e.id),_.recipient=(null===C||void 0===C?void 0:C.leadPhoneNumber)||(null===u||void 0===u||null===(i=u.lead)||void 0===i?void 0:i.leadMobile)):S&&null!==S&&void 0!==S&&S._id&&!0!==(null===e||void 0===e?void 0:e.lead)&&(O("recipient",null===S||void 0===S?void 0:S.phoneNumber),O("createByContact",null===e||void 0===e?void 0:e.id),_.recipient=null===S||void 0===S?void 0:S.phoneNumber)})(),(async()=>{A(!0);try{var e,l;let i=await(0,p.x4)("api/user/"),n=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(l=e.user)||void 0===l?void 0:l.filter((e=>{var l;return null===e||void 0===e||null===(l=e.roles)||void 0===l?void 0:l.some((e=>"Sales"===(null===e||void 0===e?void 0:e.roleName)))})))||[];I(n)}catch(i){console.error("Failed to fetch users data:",i)}finally{A(!1)}})()}),[null===e||void 0===e?void 0:e.id,S,C,u]),(0,g.jsxs)(n.aF,{onClose:l,isOpen:i,isCentered:!0,children:[(0,g.jsx)(n.mH,{}),(0,g.jsxs)(n.$m,{children:[(0,g.jsx)(n.rQ,{children:"Add Call "}),(0,g.jsx)(n.s_,{}),(0,g.jsxs)(n.cw,{children:[(0,g.jsx)(j.A,{onClose:()=>B(!1),isOpen:T,fieldName:"salesAgent",setFieldValue:O,data:F,isLoding:y,setIsLoding:A}),(0,g.jsxs)(o.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,g.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,g.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Recipient",(0,g.jsx)(o.Text,{color:"red",children:"*"})]}),(0,g.jsx)(t.Input,{fontSize:"sm",type:"number",disabled:!0,onChange:k,onBlur:G,value:null===_||void 0===_?void 0:_.recipient,name:"recipient",placeholder:"Recipient",fontWeight:"500",borderColor:null!==W&&void 0!==W&&W.recipient&&null!==w&&void 0!==w&&w.recipient?"red.300":null}),(0,g.jsxs)(o.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===W||void 0===W?void 0:W.recipient)&&(null===w||void 0===w?void 0:w.recipient)&&(null===W||void 0===W?void 0:W.recipient)]})]}),(0,g.jsxs)(o.GridItem,{colSpan:{base:12,md:6},children:[(0,g.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Start Date",(0,g.jsx)(o.Text,{color:"red",children:"*"})]}),(0,g.jsx)(t.Input,{type:"datetime-local",fontSize:"sm",onChange:k,onBlur:G,min:v()(D).format("YYYY-MM-DD HH:mm"),value:null===_||void 0===_?void 0:_.startDate,name:"startDate",fontWeight:"500",borderColor:null!==W&&void 0!==W&&W.startDate&&null!==w&&void 0!==w&&w.startDate?"red.300":null}),(0,g.jsxs)(o.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",W.startDate&&w.startDate&&W.startDate]})]}),(0,g.jsxs)(o.GridItem,{colSpan:{base:12,md:6},children:[(0,g.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Call Duration",(0,g.jsx)(o.Text,{color:"red",children:"*"})]}),(0,g.jsx)(t.Input,{fontSize:"sm",onChange:k,onBlur:G,value:null===_||void 0===_?void 0:_.callDuration,name:"callDuration",placeholder:"call Duration",fontWeight:"500",borderColor:null!==W&&void 0!==W&&W.callDuration&&null!==w&&void 0!==w&&w.callDuration?"red.300":null}),(0,g.jsxs)(o.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===W||void 0===W?void 0:W.callDuration)&&(null===w||void 0===w?void 0:w.callDuration)&&(null===W||void 0===W?void 0:W.callDuration)]})]}),(0,g.jsxs)(o.GridItem,{colSpan:{base:12},children:[(0,g.jsxs)(s.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Assign To Sales Agent",(0,g.jsx)(o.Text,{color:"red",children:"*"})]}),(0,g.jsxs)(o.Flex,{justifyContent:"space-between",children:[(0,g.jsx)(d.l6,{value:null===_||void 0===_?void 0:_.salesAgent,name:"salesAgent",onChange:k,mb:null!==W&&void 0!==W&&W.salesAgent&&null!==w&&void 0!==w&&w.salesAgent?void 0:"10px",fontWeight:"500",placeholder:"Assign To Sales Agent",borderColor:null!==W&&void 0!==W&&W.salesAgent&&null!==w&&void 0!==w&&w.salesAgent?"red.300":null,children:null===F||void 0===F?void 0:F.map((e=>(0,g.jsx)("option",{value:e._id,children:`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`},null===e||void 0===e?void 0:e._id)))}),(0,g.jsx)(a.IconButton,{onClick:()=>B(!0),ml:2,fontSize:"25px",icon:(0,g.jsx)(r.G2h,{})})]}),(0,g.jsxs)(o.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===W||void 0===W?void 0:W.salesAgent)&&(null===w||void 0===w?void 0:w.salesAgent)&&(null===W||void 0===W?void 0:W.salesAgent)]})]})]})]}),(0,g.jsxs)(n.jl,{children:[(0,g.jsx)(a.Button,{size:"sm",variant:"brand",disabled:!!y,onClick:H,children:y?(0,g.jsx)(c.A,{}):"Save"}),(0,g.jsx)(a.Button,{size:"sm",sx:{marginLeft:2,textTransform:"capitalize"},variant:"outline",colorScheme:"red",onClick:()=>{N.resetForm(),l()},children:"Close"})]})]})]})}}}]);
//# sourceMappingURL=4891.d482023a.chunk.js.map