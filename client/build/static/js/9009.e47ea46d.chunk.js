"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[9009],{1887:(e,l,o)=>{o.d(l,{A:()=>A});var i=o(4034),d=o(9942),n=o(2554),t=o(4450),a=o(8510),s=o(7682),r=o(5104),v=o(4626),u=o(5066),c=o(3186),m=o(9565),x=o(1125),h=o(9488),p=o(3516),j=o(5043),f=o(3388),g=o(9849),C=o(9621),b=o(6178),S=o.n(b),y=o(446),D=o.n(y),w=o(7508),T=o(5574),I=(o(5563),o(579));const A=e=>{var l,o,b,y,A;const{onClose:L,isOpen:z,fetchData:F,userAction:k,setAction:N,viewData:Y,id:B,view:W,data:O}=e,[M,G]=(0,j.useState)(!1),_=null===(l=JSON.parse(localStorage.getItem("user")))||void 0===l?void 0:l._id,[H,E]=(0,j.useState)([]),[V,U]=(0,j.useState)([]),$=JSON.parse(localStorage.getItem("user")),[R,P]=(0,j.useState)(!1),[J,Q]=(0,j.useState)(!1),[K,q]=(0,j.useState)(!1),Z=(0,w.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.leadData)||void 0===l?void 0:l.data})),X=null===(o=new Date)||void 0===o||null===(b=o.toISOString())||void 0===b?void 0:b.split("T")[0],ee=null===(y=new Date)||void 0===y||null===(A=y.toISOString())||void 0===A?void 0:A.split(".")[0],[le,oe]=(0,T.h)(["Leads","Contacts"]),ie=(0,w.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.contactData)||void 0===l?void 0:l.data})),de={title:"",category:"contactView"===(null===e||void 0===e?void 0:e.leadContect)?"Contact":"leadView"===(null===e||void 0===e?void 0:e.leadContect)?"Lead":"None",description:"",notes:"",assignTo:"contactView"===(null===e||void 0===e?void 0:e.leadContect)&&B?B:"",assignToLead:"leadView"===(null===e||void 0===e?void 0:e.leadContect)&&B?B:"",reminder:"",start:"",end:"",backgroundColor:"",borderColor:"#ffffff",textColor:"",allDay:!1,display:"",url:"",createBy:_},ne=(0,p.Wx)({initialValues:de,validationSchema:g.pj,enableReinitialize:!0,onSubmit:(e,l)=>{let{resetForm:o}=l;xe(),o()}}),{errors:te,touched:ae,values:se,handleBlur:re,handleChange:ve,handleSubmit:ue,setFieldValue:ce,resetForm:me}=ne,xe=async()=>{if("add"===k)try{var e,l,o,i;if(P(!0),null!==se&&void 0!==se&&se.start)se.start=null!==se&&void 0!==se&&se.allDay?null===(e=S()(null===se||void 0===se?void 0:se.start))||void 0===e?void 0:e.format("YYYY-MM-DD"):null===(l=S()(null===se||void 0===se?void 0:se.start))||void 0===l?void 0:l.format("YYYY-MM-DD HH:mm");if(null!==se&&void 0!==se&&se.end)se.end=null!==se&&void 0!==se&&se.allDay?null===(o=S()(null===se||void 0===se?void 0:se.end))||void 0===o?void 0:o.format("YYYY-MM-DD"):null===(i=S()(null===se||void 0===se?void 0:se.end))||void 0===i?void 0:i.format("YYYY-MM-DD HH:mm");let d=await(0,C.d_)("api/task/add",se);200===(null===d||void 0===d?void 0:d.status)&&(ne.resetForm(),L(),F(1),N((e=>!e)))}catch(s){console.log(s)}finally{P(!1)}else if("edit"===k)try{var d,n,t,a;if(P(!0),null!==se&&void 0!==se&&se.start)se.start=null!==se&&void 0!==se&&se.allDay?null===(d=S()(null===se||void 0===se?void 0:se.start))||void 0===d?void 0:d.format("YYYY-MM-DD"):null===(n=S()(null===se||void 0===se?void 0:se.start))||void 0===n?void 0:n.format("YYYY-MM-DD HH:mm");if(null!==se&&void 0!==se&&se.end)se.end=null!==se&&void 0!==se&&se.allDay?null===(t=S()(null===se||void 0===se?void 0:se.end))||void 0===t?void 0:t.format("YYYY-MM-DD"):null===(a=S()(null===se||void 0===se?void 0:se.end))||void 0===a?void 0:a.format("YYYY-MM-DD HH:mm");let e=await(0,C.yP)(`api/task/edit/${B}`,se);200===(null===e||void 0===e?void 0:e.status)&&(ne.resetForm(),L(),N((e=>!e)))}catch(s){console.log(s)}finally{P(!1)}};return(0,j.useEffect)((async()=>{if(se.start=null===e||void 0===e?void 0:e.date,!0===W)"Contact"===(null===se||void 0===se?void 0:se.category)&&(null===V||void 0===V?void 0:V.length)<=0?U(ie):"Lead"===(null===se||void 0===se?void 0:se.category)&&(null===H||void 0===H?void 0:H.length)<=0&&E(Z);else try{let e;var l;if("Contact"===(null===se||void 0===se?void 0:se.category)&&(null===V||void 0===V?void 0:V.length)<=0)e=await(0,C.x4)("superAdmin"===$.role?"api/contact/":`api/contact/?createBy=${$._id}`),U(null===(l=e)||void 0===l?void 0:l.data);else if("Lead"===(null===se||void 0===se?void 0:se.category)&&(null===H||void 0===H?void 0:H.length)<=0){var o;e=await(0,C.x4)("superAdmin"===(null===$||void 0===$?void 0:$.role)?"api/lead/":`api/lead/?createBy=${$._id}`),E(null===(o=e)||void 0===o?void 0:o.data)}}catch(i){console.log(i)}}),[e,null===se||void 0===se?void 0:se.category]),(0,j.useEffect)((()=>{("edit"===k||O)&&(async()=>{if(B)try{var e,l,o,i,d,n,t,a,s,r,v,u,c,m,x,h;P(!0);let p=await(0,C.x4)("api/task/view/",B);ce("title",null===p||void 0===p||null===(e=p.data)||void 0===e?void 0:e.title),ce("category",null===p||void 0===p||null===(l=p.data)||void 0===l?void 0:l.category),ce("description",null===p||void 0===p||null===(o=p.data)||void 0===o?void 0:o.description),ce("notes",null===p||void 0===p||null===(i=p.data)||void 0===i?void 0:i.notes),ce("assignTo",null===p||void 0===p||null===(d=p.data)||void 0===d?void 0:d.assignTo),ce("reminder",null===p||void 0===p||null===(n=p.data)||void 0===n?void 0:n.reminder),ce("start",null===p||void 0===p||null===(t=p.data)||void 0===t?void 0:t.start),ce("end",null===p||void 0===p||null===(a=p.data)||void 0===a?void 0:a.end),ce("backgroundColor",null===p||void 0===p||null===(s=p.data)||void 0===s?void 0:s.backgroundColor),ce("borderColor",null===p||void 0===p||null===(r=p.data)||void 0===r?void 0:r.borderColor),ce("textColor",null===p||void 0===p||null===(v=p.data)||void 0===v?void 0:v.textColor),ce("display",null===p||void 0===p||null===(u=p.data)||void 0===u?void 0:u.display),ce("url",null===p||void 0===p||null===(c=p.data)||void 0===c?void 0:c.url),ce("status",null===p||void 0===p||null===(m=p.data)||void 0===m?void 0:m.status),ce("assignToLead",null===p||void 0===p||null===(x=p.data)||void 0===x?void 0:x.assignToLead),ce("allDay",null===p||void 0===p||null===(h=p.data)||void 0===h?void 0:h.allDay)}catch(p){console.log(p)}finally{P(!1)}else O&&(ce("title",null===O||void 0===O?void 0:O.title),ce("category",null===O||void 0===O?void 0:O.category),ce("description",null===O||void 0===O?void 0:O.description),ce("notes",null===O||void 0===O?void 0:O.notes),ce("assignTo",null===O||void 0===O?void 0:O.assignTo),ce("reminder",null===O||void 0===O?void 0:O.reminder),ce("start",null===O||void 0===O?void 0:O.start),ce("end",null===O||void 0===O?void 0:O.end),ce("backgroundColor",null===O||void 0===O?void 0:O.backgroundColor),ce("borderColor",null===O||void 0===O?void 0:O.borderColor),ce("textColor",null===O||void 0===O?void 0:O.textColor),ce("display",null===O||void 0===O?void 0:O.display),ce("url",null===O||void 0===O?void 0:O.url),ce("status",null===O||void 0===O?void 0:O.status),ce("assignToLead",null===O||void 0===O?void 0:O.assignToLead),ce("allDay","Yes"===(null===O||void 0===O?void 0:O.allDay)?"Yes":"No"),ce("allDay",null===O||void 0===O?void 0:O.allDay))})()}),[k,B,O]),(0,I.jsxs)(d.aF,{isOpen:z,size:"xl",children:[!e.from&&(0,I.jsx)(d.mH,{}),(0,I.jsxs)(d.$m,{overflowY:"auto",height:"600px",children:[(0,I.jsxs)(d.rQ,{justifyContent:"space-between",display:"flex",children:["add"===k?"Create Task":"Edit Task",(0,I.jsx)(n.IconButton,{onClick:()=>L(!1),icon:(0,I.jsx)(i.CloseIcon,{})})]}),(0,I.jsxs)(d.cw,{overflowY:"auto",height:"700px",children:[(0,I.jsx)(m.A,{isOpen:J,data:V,onClose:Q,values:se,fieldName:"assignTo",setFieldValue:ce}),(0,I.jsx)(x.A,{isOpen:K,data:H,onClose:q,values:se,fieldName:"assignToLead",setFieldValue:ce}),R?(0,I.jsx)(t.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,I.jsx)(h.A,{})}):(0,I.jsxs)(t.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsxs)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Title",(0,I.jsx)(t.Text,{color:"red",children:"*"})]}),(0,I.jsx)(s.Input,{fontSize:"sm",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.title,name:"title",placeholder:"Title",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.title&&null!==ae&&void 0!==ae&&ae.title?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",fontSize:"sm",children:[" ",(null===te||void 0===te?void 0:te.title)&&(null===ae||void 0===ae?void 0:ae.title)&&(null===te||void 0===te?void 0:te.title)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Related"}),(0,I.jsx)(r.z6,{onChange:e=>{ce("category",e),ce("assignTo",null),ce("assignToLead",null)},value:se.category,children:(0,I.jsx)(t.Stack,{direction:"row",children:(0,I.jsxs)(t.Stack,{direction:"row",children:[(0,I.jsx)(r.sx,{value:"None",children:"None"}),"contactView"===(null===e||void 0===e?void 0:e.leadContect)&&(0,I.jsx)(r.sx,{value:"Contact",children:"Contact"}),"leadView"===(null===e||void 0===e?void 0:e.leadContect)&&(0,I.jsx)(r.sx,{value:"Lead",children:"Lead"}),!(null!==e&&void 0!==e&&e.leadContect)&&(0,I.jsxs)(I.Fragment,{children:[("superAdmin"===(null===$||void 0===$?void 0:$.role)||(null===oe||void 0===oe?void 0:oe.create))&&(0,I.jsx)(r.sx,{value:"Contact",children:"Contact"}),("superAdmin"===(null===$||void 0===$?void 0:$.role)||(null===le||void 0===le?void 0:le.create))&&(0,I.jsx)(r.sx,{value:"Lead",children:"Lead"})]})]})})}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.category)&&(null===ae||void 0===ae?void 0:ae.category)&&(null===te||void 0===te?void 0:te.category)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:"None"===(null===se||void 0===se?void 0:se.category)?12:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Description"}),(0,I.jsx)(s.Input,{fontSize:"sm",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.description,name:"description",placeholder:"Description",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.description&&null!==ae&&void 0!==ae&&ae.description?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",te.description&&ae.description&&te.description]})]}),"Contact"===(null===se||void 0===se?void 0:se.category)?(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Assign To Contact"}),(0,I.jsxs)(t.Flex,{justifyContent:"space-between",children:[(0,I.jsx)(v.l6,{value:null===se||void 0===se?void 0:se.assignTo,name:"assignTo",onChange:ve,mb:null!==te&&void 0!==te&&te.assignTo&&null!==ae&&void 0!==ae&&ae.assignTo?void 0:"10px",fontWeight:"500",placeholder:"Assign To",borderColor:null!==te&&void 0!==te&&te.assignTo&&null!==ae&&void 0!==ae&&ae.assignTo?"red.300":null,children:null===V||void 0===V?void 0:V.map((e=>(0,I.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:"Contact"===(null===se||void 0===se?void 0:se.category)?`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`:null===e||void 0===e?void 0:e.leadName},null===e||void 0===e?void 0:e._id)))}),(0,I.jsx)(n.IconButton,{onClick:()=>Q(!0),ml:2,fontSize:"25px",icon:(0,I.jsx)(f.G2h,{})})]}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.assignTo)&&(null===ae||void 0===ae?void 0:ae.assignTo)&&(null===te||void 0===te?void 0:te.assignTo)]})]})}):"Lead"===(null===se||void 0===se?void 0:se.category)?(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Assign To Lead"}),(0,I.jsxs)(t.Flex,{justifyContent:"space-between",children:[(0,I.jsx)(v.l6,{value:null===se||void 0===se?void 0:se.assignToLead,name:"assignToLead",onChange:ve,mb:null!==te&&void 0!==te&&te.assignToLead&&null!==ae&&void 0!==ae&&ae.assignToLead?void 0:"10px",fontWeight:"500",placeholder:"Assign To",borderColor:null!==te&&void 0!==te&&te.assignToLead&&null!==ae&&void 0!==ae&&ae.assignToLead?"red.300":null,children:null===H||void 0===H?void 0:H.map((e=>(0,I.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.leadName},null===e||void 0===e?void 0:e._id)))}),(0,I.jsx)(n.IconButton,{onClick:()=>q(!0),ml:2,fontSize:"25px",icon:(0,I.jsx)(f.G2h,{})})]}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.assignToLead)&&(null===ae||void 0===ae?void 0:ae.assignToLead)&&(null===te||void 0===te?void 0:te.assignToLead)]})]})}):"",(0,I.jsx)(t.GridItem,{colSpan:{base:12},children:(0,I.jsx)(u.Sc,{isChecked:null===se||void 0===se?void 0:se.allDay,name:"allDay",onChange:ve,children:"All Day Task ?"})}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsxs)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Start Date",(0,I.jsx)(t.Text,{color:"red",children:"*"})]}),(0,I.jsx)(s.Input,{type:null!==se&&void 0!==se&&se.allDay?"date":"datetime-local",fontSize:"sm",onChange:ve,onBlur:re,min:null!==se&&void 0!==se&&se.allDay?D()(X).format("YYYY-MM-DD"):D()(ee).format("YYYY-MM-DD HH:mm"),value:null!==se&&void 0!==se&&se.allDay?(null===se||void 0===se?void 0:se.start)&&D()(null===se||void 0===se?void 0:se.start).format("YYYY-MM-DD")||null:(null===se||void 0===se?void 0:se.start)&&D()(null===se||void 0===se?void 0:se.start).format("YYYY-MM-DD HH:mm")||null,name:"start",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.start&&null!==ae&&void 0!==ae&&ae.start?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",fontSize:"sm",color:"red",children:[" ",(null===te||void 0===te?void 0:te.start)&&(null===ae||void 0===ae?void 0:ae.start)&&(null===te||void 0===te?void 0:te.start)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"End Date"}),(0,I.jsx)(s.Input,{type:null!==se&&void 0!==se&&se.allDay?"date":"datetime-local",min:null===se||void 0===se?void 0:se.start,fontSize:"sm",onChange:ve,onBlur:re,value:null!==se&&void 0!==se&&se.allDay?(null===se||void 0===se?void 0:se.end)&&D()(null===se||void 0===se?void 0:se.end).format("YYYY-MM-DD")||null:(null===se||void 0===se?void 0:se.end)&&D()(null===se||void 0===se?void 0:se.end).format("YYYY-MM-DD HH:mm")||null,name:"end",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.end&&null!==ae&&void 0!==ae&&ae.end?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.end)&&(null===ae||void 0===ae?void 0:ae.end)&&(null===te||void 0===te?void 0:te.end)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,sm:4},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Background-Color"}),(0,I.jsx)(s.Input,{type:"color",fontSize:"sm",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.backgroundColor,name:"backgroundColor",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.backgroundColor&&null!==ae&&void 0!==ae&&ae.backgroundColor?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.backgroundColor)&&(null===ae||void 0===ae?void 0:ae.backgroundColor)&&(null===te||void 0===te?void 0:te.backgroundColor)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,sm:4},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Border-Color"}),(0,I.jsx)(s.Input,{fontSize:"sm",type:"color",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.borderColor,name:"borderColor",placeholder:"borderColor",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.borderColor&&null!==ae&&void 0!==ae&&ae.borderColor?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.borderColor)&&(null===ae||void 0===ae?void 0:ae.borderColor)&&(null===te||void 0===te?void 0:te.borderColor)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,sm:4},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Text-Color"}),(0,I.jsx)(s.Input,{fontSize:"sm",type:"color",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.textColor,name:"textColor",placeholder:"textColor",fontWeight:"500",textColor:null!==te&&void 0!==te&&te.textColor&&null!==ae&&void 0!==ae&&ae.textColor?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.textColor)&&(null===ae||void 0===ae?void 0:ae.textColor)&&(null===te||void 0===te?void 0:te.textColor)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Url"}),(0,I.jsx)(s.Input,{fontSize:"sm",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.url,name:"url",placeholder:"Enter url",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.url&&null!==ae&&void 0!==ae&&ae.url?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.url)&&(null===ae||void 0===ae?void 0:ae.url)&&(null===te||void 0===te?void 0:te.url)]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12,md:6},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Status"}),(0,I.jsxs)(v.l6,{onChange:e=>{var l;return ce("status",null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value)},value:null===se||void 0===se?void 0:se.status,style:{fontSize:"14px"},children:[(0,I.jsx)("option",{value:"todo",children:"Todo"}),(0,I.jsx)("option",{value:"onHold",children:"On Hold"}),(0,I.jsx)("option",{value:"pending",children:"Pending"}),(0,I.jsx)("option",{value:"inProgress",children:"In Progress"}),(0,I.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,I.jsxs)(t.GridItem,{colSpan:{base:12},children:[(0,I.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Notes"}),(0,I.jsx)(c.T,{resize:"none",fontSize:"sm",onChange:ve,onBlur:re,value:null===se||void 0===se?void 0:se.notes,name:"notes",placeholder:"Notes",fontWeight:"500",borderColor:null!==te&&void 0!==te&&te.notes&&null!==ae&&void 0!==ae&&ae.notes?"red.300":null}),(0,I.jsxs)(t.Text,{mb:"10px",color:"red",children:[" ",(null===te||void 0===te?void 0:te.notes)&&(null===ae||void 0===ae?void 0:ae.notes)&&(null===te||void 0===te?void 0:te.notes)]})]})]})]}),(0,I.jsxs)(d.jl,{children:[(0,I.jsx)(n.Button,{size:"sm",variant:"brand",onClick:ue,children:"add"===k?"Save":"Update"}),(0,I.jsx)(n.Button,{type:"reset",sx:{marginLeft:2,textTransform:"capitalize"},variant:"outline",colorScheme:"red",size:"sm",ml:2,onClick:()=>{L(!1),me()},children:"Close"})]})]})]})}},4406:(e,l,o)=>{o(6178),o(5043),o(1094),o(6914),o(8152),o(9250),o(2853),o(579)},4799:(e,l,o)=>{o.d(l,{A:()=>C});var i=o(4034),d=o(9942),n=o(2554),t=o(4450),a=o(8510),s=o(4626),r=o(6654),v=o(4614),u=o(9488),c=o(3516),m=o(5043),x=o(3388),h=o(9621),p=o(2030),j=o(8908),f=o(899),g=(o(8878),o(579));const C=e=>{var l,o,C,b;const[S,y]=(0,m.useState)(!1),[D,w]=(0,m.useState)(!1),[T,I]=(0,m.useState)([]),[A,L]=(0,m.useState)([]),[z,F]=(0,m.useState)(!1),k=JSON.parse(localStorage.getItem("user")),N={...Object.fromEntries(null===(l=(null===e||void 0===e||null===(o=e.leadData)||void 0===o?void 0:o.fields)||[])||void 0===l?void 0:l.map((e=>[null===e||void 0===e?void 0:e.name,""]))),associatedListing:"",assignUser:"",createBy:null===(C=JSON.parse(localStorage.getItem("user")))||void 0===C?void 0:C._id},Y=(0,c.Wx)({initialValues:N,validationSchema:f.object().shape((0,p.g)(null===e||void 0===e||null===(b=e.leadData)||void 0===b?void 0:b.fields)),onSubmit:(e,l)=>{let{resetForm:o}=l;E()}}),{errors:B,touched:W,values:O,handleBlur:M,handleChange:G,handleSubmit:_,setFieldValue:H}=Y;(0,m.useEffect)((()=>{(async()=>{var e;y(!0);let l=await(0,h.x4)("api/user/");L(null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.user),y(!1)})()}),[]);const E=async()=>{try{var l;y(!0);let o=await(0,h.d_)("api/form/add",{...O,moduleId:null===e||void 0===e||null===(l=e.leadData)||void 0===l?void 0:l._id});200===(null===o||void 0===o?void 0:o.status)&&(e.onClose(),Y.resetForm(),e.setAction((e=>!e)))}catch(o){console.log(o)}finally{y(!1)}};return(0,m.useEffect)((()=>{(async()=>{let e=await(0,h.x4)("superAdmin"===(null===k||void 0===k?void 0:k.role)?"api/property":`api/property/?createBy=${null===k||void 0===k?void 0:k._id}`);I(null===e||void 0===e?void 0:e.data)})()}),[]),(0,g.jsxs)("div",{children:[(0,g.jsxs)(d._s,{isOpen:null===e||void 0===e?void 0:e.isOpen,size:null===e||void 0===e?void 0:e.size,children:[(0,g.jsx)(d.QP,{}),(0,g.jsxs)(d.zj,{children:[(0,g.jsxs)(d.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Add Lead",(0,g.jsx)(n.IconButton,{onClick:null===e||void 0===e?void 0:e.onClose,icon:(0,g.jsx)(i.CloseIcon,{})})]}),(0,g.jsxs)(d.ys,{children:[(0,g.jsx)(j.A,{moduleData:null===e||void 0===e?void 0:e.leadData,values:O,setFieldValue:H,handleChange:G,handleBlur:M,errors:B,touched:W}),(0,g.jsx)(t.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,mt:2,children:(0,g.jsxs)(t.GridItem,{colSpan:{base:12},children:[(0,g.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Associated Listing"}),(0,g.jsxs)(t.Flex,{justifyContent:"space-between",children:[(0,g.jsx)(s.l6,{value:null===O||void 0===O?void 0:O.associatedListing,name:"associatedListing",onChange:G,mb:null!==B&&void 0!==B&&B.associatedListing&&null!==W&&void 0!==W&&W.associatedListing?void 0:"10px",fontWeight:"500",placeholder:"select associated listing",borderColor:null!==B&&void 0!==B&&B.associatedListing&&null!==W&&void 0!==W&&W.associatedListing?"red.300":null,children:null===T||void 0===T?void 0:T.map((e=>(0,g.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id)))}),(0,g.jsx)(n.IconButton,{onClick:()=>w(!0),ml:2,fontSize:"25px",icon:(0,g.jsx)(x.G2h,{})})]}),(0,g.jsx)(t.Text,{mb:"10px",fontSize:"sm",color:"red",children:(null===B||void 0===B?void 0:B.associatedListing)&&(null===W||void 0===W?void 0:W.associatedListing)&&(null===B||void 0===B?void 0:B.associatedListing)})]})}),(0,g.jsx)(t.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,mt:2,children:(0,g.jsxs)(t.GridItem,{colSpan:{base:12},children:[(0,g.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Assign to User"}),(0,g.jsxs)(t.Flex,{justifyContent:"space-between",children:[(0,g.jsx)(s.l6,{value:null===O||void 0===O?void 0:O.assignUser,name:"assignUser",onChange:G,mb:null!==B&&void 0!==B&&B.assignUser&&null!==W&&void 0!==W&&W.assignUser?void 0:"10px",fontWeight:"500",placeholder:"select user",borderColor:null!==B&&void 0!==B&&B.assignUser&&null!==W&&void 0!==W&&W.assignUser?"red.300":null,children:null===A||void 0===A?void 0:A.map((e=>(0,g.jsxs)("option",{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.firstName," ",null===e||void 0===e?void 0:e.lastName]},null===e||void 0===e?void 0:e._id)))}),(0,g.jsx)(n.IconButton,{onClick:()=>F(!0),ml:2,fontSize:"25px",icon:(0,g.jsx)(x.G2h,{})})]}),(0,g.jsx)(t.Text,{mb:"10px",fontSize:"sm",color:"red",children:(null===B||void 0===B?void 0:B.assignUser)&&(null===W||void 0===W?void 0:W.assignUser)&&(null===B||void 0===B?void 0:B.assignUser)})]})})]}),(0,g.jsxs)(d.tb,{children:[(0,g.jsx)(n.Button,{sx:{textTransform:"capitalize"},size:"sm",disabled:!!S,variant:"brand",type:"submit",onClick:_,children:S?(0,g.jsx)(u.A,{}):"Save"}),(0,g.jsx)(n.Button,{variant:"outline",colorScheme:"red",size:"sm",sx:{marginLeft:2,textTransform:"capitalize"},onClick:()=>{Y.resetForm(),e.onClose()},children:"Close"})]})]})]}),(0,g.jsx)(r.A,{onClose:()=>w(!1),isOpen:D,data:T,isLoding:S,setIsLoding:y,fieldName:"associatedListing",setFieldValue:H}),(0,g.jsx)(v.A,{onClose:()=>F(!1),isOpen:z,fieldName:"assignUser",setFieldValue:H,data:A,isLoding:S,setIsLoding:y})]})}},5563:(e,l,o)=>{o.r(l),o.d(l,{default:()=>H});var i=o(4034),d=o(1206),n=o(9754),t=o(4450),a=o(8858),s=o(5376),r=o(2554),v=o(962),u=o(216),c=o(3994),m=o(9488),x=o(2770),h=o(5043),p=o(4960),j=o(3216),f=o(5475),g=o(2145),C=o(9621),b=(o(4406),o(6)),S=o(9066),y=o(9250),D=o(4799),w=o(8878),T=o(5574),I=o(2853),A=o(9702),L=o(8618),z=o(8177),F=o(8031),k=o(6178),N=o.n(k),Y=o(1887),B=o(7508),W=o(7892),O=o(5369),M=o(74),G=o.n(M),_=o(579);const H=()=>{var e,l,o,k,M,H,E,V,U,$,R,P,J,Q,K,q,Z,X,ee,le,oe,ie;const de=(0,j.g)(),ne=JSON.parse(localStorage.getItem("user")),te=(0,d.dU)("gray.500","white"),[ae,se]=(0,h.useState)(),[re,ve]=(0,h.useState)([]),{isOpen:ue,onOpen:ce,onClose:me}=(0,n.j1)(),[xe,he]=(0,h.useState)(!1),[pe,je]=(0,h.useState)(!1),[fe,ge]=(0,h.useState)(!1),[Ce,be]=(0,h.useState)(!1),[Se,ye]=(0,h.useState)(!1),[De,we]=(0,h.useState)(!1),[Te,Ie]=(0,h.useState)(!1),[Ae,Le]=(0,h.useState)(!1),[ze,Fe]=(0,h.useState)(!1),[ke,Ne]=(0,h.useState)(!1),[Ye,Be]=(0,h.useState)(0),[We,Oe]=(0,h.useState)(!1),[Me,Ge]=(0,h.useState)([]),[_e,He]=(0,h.useState)(""),Ee=(0,j.Zp)(),Ve=(0,B.wA)(),[Ue,$e]=(0,h.useState)(!1),[Re,Pe]=(0,h.useState)(!1),Je=(0,B.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.leadCustomFiled)||void 0===l?void 0:l.data.data})),Qe=null===Me||void 0===Me?void 0:Me.find((e=>(null===e||void 0===e?void 0:e._id)===(null===ae||void 0===ae?void 0:ae.assignUser)));(0,h.useEffect)((()=>{Ke()}),[]);const Ke=async()=>{var e;let l=await(0,C.x4)("api/user/");Ge(null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.user)},[qe,Ze,Xe,el,ll,ol,il]=(0,T.h)(["Leads","Tasks","Meetings","Calls","Emails","Tasks","Meetings"]),dl=[{Header:"sender",accessor:"senderName"},{Header:"recipient",accessor:"createByName",cell:e=>{var l,o;return(0,_.jsx)(f.N_,{to:`/Email/${null===e||void 0===e||null===(l=e.row)||void 0===l||null===(o=l.original)||void 0===o?void 0:o._id}`,children:(0,_.jsx)(t.Text,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||" - "})})}},{Header:"time stamp",accessor:"timestamp",cell:e=>(0,_.jsx)("div",{className:"selectOpt",children:(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e?void 0:e.value).fromNow()})})},{Header:"Created",accessor:"createBy",cell:e=>{var l;return(0,_.jsx)("div",{className:"selectOpt",children:(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e||null===(l=e.row)||void 0===l?void 0:l.values.timestamp).format("h:mma (DD/MM)")})})}}],nl=[{Header:"sender",accessor:"senderName"},{Header:"recipient",accessor:"createByName",cell:e=>{var l,o;return(0,_.jsx)(f.N_,{to:`/phone-call/${null===e||void 0===e||null===(l=e.row)||void 0===l||null===(o=l.original)||void 0===o?void 0:o._id}`,children:(0,_.jsx)(t.Text,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||" - "})})}},{Header:"time stamp",accessor:"timestamp",cell:e=>(0,_.jsx)("div",{className:"selectOpt",children:(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e?void 0:e.value).fromNow()})})},{Header:"Created",accessor:"createBy",cell:e=>{var l;return(0,_.jsx)("div",{className:"selectOpt",children:(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e||null===(l=e.row)||void 0===l?void 0:l.values.timestamp).format("h:mma (DD/MM)")})})}}],tl=[{Header:"Agenda",accessor:"agenda",cell:e=>{var l,o;return(0,_.jsx)(f.N_,{to:`/metting/${null===e||void 0===e||null===(l=e.row)||void 0===l||null===(o=l.original)||void 0===o?void 0:o._id}`,children:(0,_.jsx)(t.Text,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||" - "})})}},{Header:"date Time",accessor:"dateTime"},{Header:"times tamp",accessor:"timestamp",cell:e=>(0,_.jsx)("div",{className:"selectOpt",children:(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:N()(null===e||void 0===e?void 0:e.value).fromNow()})})},{Header:"create By",accessor:"createdByName"}],al=[{Header:"Title",accessor:"title",type:"text",formikType:"",cell:e=>(0,_.jsx)("div",{className:"selectOpt",children:(0,_.jsx)(t.Text,{onClick:()=>{var l;return Ee(`/view/${null===e||void 0===e||null===(l=e.row)||void 0===l?void 0:l.original._id}`)},me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"},cursor:"pointer"},color:"brand.600",fontSize:"sm",fontWeight:"700",children:null===e||void 0===e?void 0:e.value})})},{Header:"Category",accessor:"category"},{Header:"Assign To",accessor:"assignToName"},{Header:"Start Date",accessor:"start"},{Header:"End Date",accessor:"end"}],sl=[{Header:"Type",accessor:"type"},{Header:"Last Communication",accessor:"lastCommunicationDate",cell:e=>{var l,o,i,d;return(0,_.jsxs)("div",{className:"selectOpt",children:[(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&null!==(l=e.row)&&void 0!==l&&l.values.lastCommunicationDate?N()(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.values.lastCommunicationDate).format("DD-MM-YYYY hh:mm A"):"-"}),(null===e||void 0===e||null===(i=e.row)||void 0===i?void 0:i.values.lastCommunicationDate)&&(0,_.jsx)(t.Text,{color:"white",fontSize:"sm",fontWeight:"700",style:{border:"1px solid",borderRadius:"5px",padding:"5px"},className:"completed",children:N()(null===e||void 0===e||null===(d=e.row)||void 0===d?void 0:d.values.lastCommunicationDate,"YYYYMMDD").fromNow()})]})}},{Header:"Scheduled Communication",accessor:"scheduledCommunicationDate",cell:e=>{var l,o,i,d;return(0,_.jsxs)("div",{className:"selectOpt",children:[(0,_.jsx)(t.Text,{color:te,fontSize:"sm",fontWeight:"700",children:null!==e&&void 0!==e&&null!==(l=e.row)&&void 0!==l&&l.values.scheduledCommunicationDate?N()(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.values.scheduledCommunicationDate).format("DD-MM-YYYY hh:mm A"):"-"}),(null===e||void 0===e||null===(i=e.row)||void 0===i?void 0:i.values.scheduledCommunicationDate)&&(0,_.jsx)(t.Text,{color:"white",fontSize:"sm",fontWeight:"700",style:{border:"1px solid",borderRadius:"5px",padding:"5px"},className:"pending",children:N()(null===e||void 0===e||null===(d=e.row)||void 0===d?void 0:d.values.scheduledCommunicationDate,"YYYYMMDD").fromNow()})]})}}],rl=async e=>{if(e){var l;let o=await(0,C.x4)("api/document/download/",e);o&&200===(null===o||void 0===o?void 0:o.status)?(window.open(`${null===x.d||void 0===x.d?void 0:x.d.baseUrl}api/document/download/${e}`),g.oR.success("file Download successful")):o&&404===(null===o||void 0===o||null===(l=o.response)||void 0===l?void 0:l.status)&&g.oR.error("file Not Found")}},vl=async e=>{try{ge(!0);let o=await(0,C.x4)("api/lead/view/",null===de||void 0===de?void 0:de.id);var l;if(200===o.status)se(null===o||void 0===o||null===(l=o.data)||void 0===l?void 0:l.lead),ve(null===o||void 0===o?void 0:o.data);ge(!1),Be(e)}catch(o){console.error("Error fetching data:",o),ge(!1)}};(0,h.useEffect)((()=>{vl(),Ve((0,W.y)())}),[ke]);const ul=null===Object||void 0===Object?void 0:Object.values(de)[0],cl=null===ul||void 0===ul?void 0:ul.split("/"),ml=(e,l)=>{var o,i;if(!Array.isArray(e))return{lastCommunicationDate:null,scheduledCommunicationDate:null};const d=new Date,n=e.filter((e=>new Date(e[l])<d)).sort(((e,o)=>new Date(o[l])-new Date(e[l]))),t=e.filter((e=>new Date(e[l])>d)).sort(((e,o)=>new Date(e[l])-new Date(o[l])));return{lastCommunicationDate:(null===(o=n[0])||void 0===o?void 0:o[l])||null,scheduledCommunicationDate:(null===(i=t[0])||void 0===i?void 0:i[l])||null}},xl=[{type:"Email",...ml(null===re||void 0===re?void 0:re.Email,"startDate")},{type:"Call",...ml(null===re||void 0===re?void 0:re.phoneCall,"startDate")},{type:"Task",...ml(null===re||void 0===re?void 0:re.task,"start")},{type:"Meeting",...ml(null===re||void 0===re?void 0:re.meeting,"dateTime")}];return(0,_.jsxs)(_.Fragment,{children:[fe?(0,_.jsx)(t.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,_.jsx)(m.A,{})}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(t.Heading,{size:"lg",mt:0,m:3,children:(null===ae||void 0===ae?void 0:ae.leadName)||""}),(0,_.jsxs)(a.tU,{onChange:e=>{Be(e)},index:Ye,children:[(0,_.jsxs)(t.Grid,{templateColumns:"repeat(12, 1fr)",mb:3,gap:1,children:[(0,_.jsx)(t.GridItem,{colSpan:{base:12,md:6},children:(0,_.jsxs)(a.wb,{sx:{border:"none","& button:focus":{boxShadow:"none"},"& button":{margin:{sm:"0 3px",md:"0 5px"},padding:{sm:"5px",md:"8px"},border:"2px solid #8080803d",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",borderBottom:0,fontSize:{sm:"12px",md:"16px"}},'& button[aria-selected="true"]':{border:"2px solid brand.200",borderBottom:0,zIndex:"0"}},children:[(0,_.jsx)(a.oz,{children:"Information"}),((null===ll||void 0===ll?void 0:ll.view)||(null===el||void 0===el?void 0:el.view)||(null===ol||void 0===ol?void 0:ol.view)||(null===il||void 0===il?void 0:il.view))&&(0,_.jsx)(a.oz,{children:" Communication"}),(0,_.jsx)(a.oz,{children:"Document"})]})}),(0,_.jsx)(t.GridItem,{colSpan:{base:12,md:6},mt:{sm:"3px",md:"5px"},children:(0,_.jsxs)(t.Flex,{justifyContent:"right",children:[(0,_.jsxs)(s.W1,{children:[("superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||(null===qe||void 0===qe?void 0:qe.create)||(null===qe||void 0===qe?void 0:qe.update)||(null===qe||void 0===qe?void 0:qe.delete))&&(0,_.jsx)(s.IU,{size:"sm",variant:"outline",colorScheme:"blackAlpha",mr:2.5,as:r.Button,rightIcon:(0,_.jsx)(i.ChevronDownIcon,{}),children:"Actions"}),(0,_.jsx)(s.Nj,{}),(0,_.jsxs)(s.cO,{minWidth:2,children:[("superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||(null===qe||void 0===qe?void 0:qe.create))&&(0,_.jsx)(s.Dr,{color:"blue",onClick:()=>ce(),alignItems:"start",icon:(0,_.jsx)(i.AddIcon,{}),children:"Add"}),("superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||(null===qe||void 0===qe?void 0:qe.update))&&(0,_.jsx)(s.Dr,{onClick:()=>{he(!0),He(de.id)},alignItems:"start",icon:(0,_.jsx)(i.EditIcon,{}),children:"Edit"}),(0,_.jsx)(s.Dr,{onClick:()=>{const e=document.getElementById("reports");e?(e.style.display="block",e.style.width="100%",e.style.height="auto",G()().from(e).set({margin:[0,0,0,0],filename:`Lead_Details_${N()().format("DD-MM-YYYY")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}}).save().then((()=>{e.style.display=""}))):console.error("Element with ID 'reports' not found.")},alignItems:"start",icon:(0,_.jsx)(O.kl1,{}),display:"flex",style:{alignItems:"center"},children:"Print as PDF"}),("superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||(null===qe||void 0===qe?void 0:qe.delete))&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.Nj,{}),(0,_.jsx)(s.Dr,{alignItems:"start",color:"red",onClick:()=>je(!0),icon:(0,_.jsx)(i.DeleteIcon,{}),children:"Delete"})]})]})]}),(0,_.jsx)(f.N_,{to:"/lead",children:(0,_.jsx)(r.Button,{leftIcon:(0,_.jsx)(p.m6W,{}),size:"sm",variant:"brand",children:"Back"})})]})})]}),(0,_.jsxs)(a.T2,{children:[(0,_.jsxs)(a.Kp,{pt:4,p:0,children:[(0,_.jsx)(A.A,{data:null===Je||void 0===Je?void 0:Je[0],fieldData:ae||[],toCamelCase:function(e){return null===e||void 0===e?void 0:e.replace(/([a-z])([A-Z])/g,"$1 $2")},moduleId:null===Je||void 0===Je||null===(e=Je[0])||void 0===e?void 0:e._id,fetchData:vl,id:"reports"}),(0,_.jsx)(u.A,{mt:3,children:(0,_.jsxs)(t.Grid,{templateColumns:"repeat(12, 1fr)",children:[(0,_.jsxs)(t.GridItem,{colSpan:{base:6},children:[(0,_.jsx)(t.Text,{fontSize:"sm",fontWeight:"bold",color:"blackAlpha.900",children:"Associated Listing"}),(0,_.jsx)(t.Text,{children:null!==ae&&void 0!==ae&&null!==(l=ae.associatedListing)&&void 0!==l&&l.name?ae.associatedListing.name:" - "})]}),(0,_.jsxs)(t.GridItem,{colSpan:{base:6},children:[(0,_.jsx)(t.Text,{fontSize:"sm",fontWeight:"bold",color:"blackAlpha.900",children:"Assign to User"}),(0,_.jsxs)(t.Text,{children:[null===Qe||void 0===Qe?void 0:Qe.firstName," ",null===Qe||void 0===Qe?void 0:Qe.lastName]})]})]})}),(0,_.jsx)(u.A,{mt:3,children:(0,_.jsx)(F.A,{title:"History",isLoding:fe,columnData:null!==sl&&void 0!==sl?sl:[],allData:xl||[],tableData:xl||[],AdvanceSearch:!1,checkBox:!1,tableCustomFields:[],deleteMany:!0})})]}),(0,_.jsx)(a.Kp,{pt:4,p:0,children:(0,_.jsx)(t.GridItem,{colSpan:{base:4},children:(0,_.jsx)(t.Grid,{overflow:"hidden",templateColumns:{base:"1fr"},gap:4,children:(0,_.jsxs)(t.Grid,{templateColumns:"repeat(12, 1fr)",gap:4,children:[(null===ll||void 0===ll?void 0:ll.view)&&(0,_.jsx)(t.GridItem,{colSpan:{base:12,md:6},children:(0,_.jsxs)(u.A,{children:[(0,_.jsx)(F.A,{title:"Email",isLoding:fe,columnData:null!==dl&&void 0!==dl?dl:[],allData:Se?null===re||void 0===re?void 0:re.Email:(null===re||void 0===re||null===(o=re.Email)||void 0===o?void 0:o.length)>0?[null===re||void 0===re?void 0:re.Email[0]]:[],tableData:Se?null===re||void 0===re?void 0:re.Email:(null===re||void 0===re||null===(k=re.Email)||void 0===k?void 0:k.length)>0?[null===re||void 0===re?void 0:re.Email[0]]:[],AdvanceSearch:!1,dataLength:null===re||void 0===re||null===(M=re.Email)||void 0===M?void 0:M.length,tableCustomFields:[],checkBox:!1,deleteMany:!0,ManageGrid:!1,onOpen:()=>$e(!0),access:ll}),(null===re||void 0===re||null===(H=re.Email)||void 0===H?void 0:H.length)>1&&(0,_.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,_.jsx)(r.Button,{size:"sm",colorScheme:"brand",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>ye(!Se),children:Se?"Show less":"Show more"})})]})}),(null===el||void 0===el?void 0:el.view)&&(0,_.jsx)(t.GridItem,{colSpan:{base:12,md:6},children:(0,_.jsxs)(u.A,{children:[(0,_.jsx)(F.A,{title:"Call",isLoding:fe,columnData:null!==nl&&void 0!==nl?nl:[],allData:De?null===re||void 0===re?void 0:re.phoneCall:(null===re||void 0===re||null===(E=re.phoneCall)||void 0===E?void 0:E.length)>0?[null===re||void 0===re?void 0:re.phoneCall[0]]:[],tableData:De?null===re||void 0===re?void 0:re.phoneCall:(null===re||void 0===re||null===(V=re.phoneCall)||void 0===V?void 0:V.length)>0?[null===re||void 0===re?void 0:re.phoneCall[0]]:[],AdvanceSearch:!1,dataLength:null===re||void 0===re||null===(U=re.phoneCall)||void 0===U?void 0:U.length,tableCustomFields:[],checkBox:!1,deleteMany:!0,ManageGrid:!1,onOpen:()=>Pe(!0),access:el}),(null===re||void 0===re||null===($=re.phoneCall)||void 0===$?void 0:$.length)>1&&(0,_.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,_.jsx)(r.Button,{size:"sm",colorScheme:"brand",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>we(!De),children:De?"Show less":"Show more"})})]})}),(null===ol||void 0===ol?void 0:ol.view)&&(0,_.jsx)(t.GridItem,{colSpan:{base:12,md:6},children:(0,_.jsxs)(u.A,{children:[(0,_.jsx)(F.A,{title:"Task",isLoding:fe,columnData:null!==al&&void 0!==al?al:[],allData:Te?null===re||void 0===re?void 0:re.task:(null===re||void 0===re||null===(R=re.task)||void 0===R?void 0:R.length)>0?[null===re||void 0===re?void 0:re.task[0]]:[],tableData:Te?null===re||void 0===re?void 0:re.task:(null===re||void 0===re||null===(P=re.task)||void 0===P?void 0:P.length)>0?[null===re||void 0===re?void 0:re.task[0]]:[],dataLength:null===re||void 0===re||null===(J=re.task)||void 0===J?void 0:J.length,AdvanceSearch:!1,tableCustomFields:[],checkBox:!1,deleteMany:!0,ManageGrid:!1,onOpen:()=>Oe(!0),access:ol}),(null===re||void 0===re||null===(Q=re.task)||void 0===Q?void 0:Q.length)>1&&(0,_.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,_.jsx)(r.Button,{size:"sm",colorScheme:"brand",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>Ie(!Te),children:Te?"Show less":"Show more"})})]})}),(null===il||void 0===il?void 0:il.view)&&(0,_.jsx)(t.GridItem,{colSpan:{base:12,md:6},children:(0,_.jsxs)(u.A,{overflow:"scroll",children:[(0,_.jsx)(F.A,{title:"Meeting",isLoding:fe,columnData:null!==tl&&void 0!==tl?tl:[],allData:Ae?null===re||void 0===re?void 0:re.meeting:(null===re||void 0===re||null===(K=re.meeting)||void 0===K?void 0:K.length)>0?[null===re||void 0===re?void 0:re.meeting[0]]:[],tableData:Ae?null===re||void 0===re?void 0:re.meeting:(null===re||void 0===re||null===(q=re.meeting)||void 0===q?void 0:q.length)>0?[null===re||void 0===re?void 0:re.meeting[0]]:[],AdvanceSearch:!1,dataLength:null===re||void 0===re||null===(Z=re.meeting)||void 0===Z?void 0:Z.length,tableCustomFields:[],checkBox:!1,deleteMany:!0,ManageGrid:!1,onOpen:()=>be(!0),access:il}),(null===re||void 0===re||null===(X=re.meeting)||void 0===X?void 0:X.length)>1&&(0,_.jsx)("div",{style:{display:"flex",justifyContent:"end"},children:(0,_.jsx)(r.Button,{colorScheme:"brand",size:"sm",variant:"outline",display:"flex",justifyContant:"end",onClick:()=>Le(!Ae),children:Ae?"Show less":"Show more"})})]})})]})})})}),(0,_.jsx)(a.Kp,{pt:4,p:0,children:(0,_.jsx)(t.GridItem,{colSpan:{base:4},children:(0,_.jsxs)(u.A,{minH:"50vh",children:[(0,_.jsxs)(t.Flex,{alignItems:"center",justifyContent:"space-between",mb:"2",children:[(0,_.jsx)(t.Heading,{size:"md",mb:3,children:"Documents"}),(0,_.jsx)(r.Button,{leftIcon:(0,_.jsx)(i.AddIcon,{}),size:"sm",variant:"brand",onClick:()=>Fe(!0),children:"Add Document"})]}),(0,_.jsx)(c.E,{}),(0,_.jsx)(t.VStack,{mt:4,alignItems:"flex-start",children:(null===re||void 0===re||null===(ee=re.Document)||void 0===ee?void 0:ee.length)>0?null===re||void 0===re||null===(le=re.Document)||void 0===le?void 0:le.map((e=>{var l;return(0,_.jsx)(v.A,{name:null===e||void 0===e?void 0:e.folderName,item:e,children:null===e||void 0===e||null===(l=e.files)||void 0===l?void 0:l.map((e=>(0,_.jsx)(v.A,{download:rl,data:e,name:null===e||void 0===e?void 0:e.fileName,isFile:!0,from:"lead"})))})})):(0,_.jsx)(t.Text,{textAlign:"center",width:"100%",color:te,fontSize:"sm",fontWeight:"700",children:(0,_.jsx)(I.A,{})})})]})})})]})]}),("superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||(null===qe||void 0===qe?void 0:qe.update)||(null===qe||void 0===qe?void 0:qe.delete))&&(0,_.jsx)(u.A,{mt:3,children:(0,_.jsx)(t.Grid,{templateColumns:"repeat(6, 1fr)",gap:1,children:(0,_.jsx)(t.GridItem,{colStart:6,children:(0,_.jsxs)(t.Flex,{justifyContent:"right",children:["superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||null!==qe&&void 0!==qe&&qe.update?(0,_.jsx)(r.Button,{size:"sm",onClick:()=>he(!0),leftIcon:(0,_.jsx)(i.EditIcon,{}),mr:2.5,variant:"outline",colorScheme:"green",children:"Edit"}):"","superAdmin"===(null===ne||void 0===ne?void 0:ne.role)||null!==qe&&void 0!==qe&&qe.delete?(0,_.jsx)(r.Button,{size:"sm",style:{background:"red.800"},onClick:()=>je(!0),leftIcon:(0,_.jsx)(i.DeleteIcon,{}),colorScheme:"red",children:"Delete"}):""]})})})})]}),ue&&(0,_.jsx)(D.A,{isOpen:ue,size:"lg",onClose:me,leadData:null===Je||void 0===Je?void 0:Je[0],setAction:Ne}),xe&&(0,_.jsx)(w.A,{isOpen:xe,size:"lg",onClose:he,leadData:null===Je||void 0===Je?void 0:Je[0],setAction:Ne,moduleId:null===Je||void 0===Je||null===(oe=Je[0])||void 0===oe?void 0:oe._id,data:ae}),(0,_.jsx)(S.A,{fetchData:vl,isOpen:Ce,leadContect:null===cl||void 0===cl?void 0:cl[0],onClose:be,from:"contact",id:de.id,setAction:Ne,view:!0,leadName:ae}),(0,_.jsx)(Y.A,{isOpen:We,fetchData:vl,leadContect:null===cl||void 0===cl?void 0:cl[0],onClose:Oe,id:null===de||void 0===de?void 0:de.id,userAction:"add",view:!0}),(0,_.jsx)(y.A,{viewData:re,fetchData:vl,isOpen:Re,onClose:Pe,setAction:Ne,data:null===ae||void 0===ae?void 0:ae.contact,id:null===de||void 0===de?void 0:de.id,lead:!0,LData:ae}),(0,_.jsx)(b.A,{lead:!0,leadEmail:null===re||void 0===re||null===(ie=re.lead)||void 0===ie?void 0:ie.leadEmail,fetchData:vl,isOpen:Ue,onClose:$e,id:null===de||void 0===de?void 0:de.id}),(0,_.jsx)(L.A,{addDocument:ze,setAddDocument:Fe,linkId:null===de||void 0===de?void 0:de.id,from:"lead",setAction:Ne,fetchData:vl}),(0,_.jsx)(z.A,{isOpen:pe,onClose:()=>je(!1),type:"Lead",handleDeleteData:async e=>{try{ge(!0);let l=await(0,C.Gx)("api/lead/delete/",e);200===(null===l||void 0===l?void 0:l.status)&&(je(!1),Ne((e=>!e)),Ee("/lead"))}catch(l){console.log(l)}finally{ge(!1)}},ids:null===de||void 0===de?void 0:de.id})]})}},6654:(e,l,o)=>{o.d(l,{A:()=>m});var i=o(9942),d=o(4450),n=o(2554),t=o(8031),a=o(9488),s=o(5043),r=o(8860),v=o(7508),u=o(3915),c=o(579);const m=e=>{var l,o;const{onClose:m,isOpen:x,fieldName:h,setFieldValue:p,data:j}=e,[f,g]=(0,s.useState)(),[C,b]=(0,s.useState)([]),[S,y]=(0,s.useState)(!1),[D,w]=(0,s.useState)([]),T=(0,v.wA)();return(0,s.useEffect)((async()=>{(async()=>{var e,l,o,i;y(!0);const d=await T((0,u.R)());b(null===d||void 0===d||null===(e=d.payload)||void 0===e?void 0:e.data);const n=[{Header:"#",accessor:"_id",isSortable:!1,width:10},...((null===d||void 0===d||null===(l=d.payload)||void 0===l||null===(o=l.data)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.fields)||[]).filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))).map((e=>({Header:null===e||void 0===e?void 0:e.label,accessor:null===e||void 0===e?void 0:e.name})))];w(n),y(!1)})()}),[]),(0,c.jsxs)(i.aF,{onClose:m,size:"full",isOpen:x,children:[(0,c.jsx)(i.mH,{}),(0,c.jsxs)(i.$m,{children:[(0,c.jsx)(i.rQ,{children:"Select Property"}),(0,c.jsx)(i.s_,{}),(0,c.jsx)(i.cw,{children:S?(0,c.jsx)(d.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,c.jsx)(a.A,{})}):(0,c.jsx)(t.A,{title:"Property",isLoding:S,columnData:null!==D&&void 0!==D?D:[],allData:null!==j&&void 0!==j?j:[],tableData:j,tableCustomFields:(null===C||void 0===C||null===(l=C[0])||void 0===l||null===(o=l.fields)||void 0===o?void 0:o.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||[],AdvanceSearch:()=>"",ManageGrid:!1,deleteMany:!1,selectedValues:f,setSelectedValues:g,selectType:"single",customSearch:!1})}),(0,c.jsxs)(i.jl,{children:[(0,c.jsx)(n.Button,{variant:"brand",size:"sm",me:2,onClick:async()=>{try{y(!0),p(h,f),m()}catch(e){console.log(e)}finally{y(!1)}},disabled:!!S,leftIcon:(0,c.jsx)(r.NLY,{}),children:S?(0,c.jsx)(a.A,{}):"Select"}),(0,c.jsx)(n.Button,{variant:"outline",size:"sm",colorScheme:"red",onClick:()=>m(),children:"Close"})]})]})]})}},8618:(e,l,o)=>{o.d(l,{A:()=>p});var i=o(9942),d=o(4450),n=o(8510),t=o(7682),a=o(2554),s=o(5043),r=o(3516),v=o(9488),u=o(9621),c=o(9849);const m={formData:e=>{var l,o;const i=new FormData;return null===Object||void 0===Object||null===(l=Object.entries(e))||void 0===l||l.forEach((e=>{let[l,o]=e;null===i||void 0===i||i.append(l,o)})),null===e||void 0===e||null===(o=e.files)||void 0===o||o.forEach((e=>{null===i||void 0===i||i.append("files",e)})),i}};var x=o(8966),h=o(579);const p=e=>{var l;let{setAddDocument:o,addDocument:p,linkId:j,from:f,setAction:g,fetchData:C}=e;const[b,S]=(0,s.useState)(!1),y=JSON.parse(localStorage.getItem("user")),D={folderName:"",files:"",filename:"",linkLead:"lead"===f&&j,linkContact:"contact"===f&&j,createBy:null===y||void 0===y?void 0:y._id},w=(0,r.Wx)({initialValues:D,validationSchema:c.L8,onSubmit:(e,l)=>{let{resetForm:o}=l;Y()}}),{errors:T,touched:I,values:A,handleBlur:L,handleChange:z,handleSubmit:F,setFieldValue:k,resetForm:N}=w,Y=async()=>{try{S(!0);const e=null===m||void 0===m?void 0:m.formData(A);let l=await(0,u.d_)("lead"===f?"api/document/addDocumentLead":"api/document/addDocumentContact",e);l&&200===(null===l||void 0===l?void 0:l.status)&&(w.resetForm(),C(2),o(!1))}catch(e){console.log(e)}finally{S(!1)}};return(0,h.jsxs)(i.aF,{onClose:()=>o(!1),isOpen:p,isCentered:!0,children:[(0,h.jsx)(i.mH,{}),(0,h.jsxs)(i.$m,{maxWidth:"2xl",children:[(0,h.jsx)(i.rQ,{}),(0,h.jsx)(i.s_,{}),(0,h.jsxs)(i.cw,{children:[(0,h.jsxs)(d.Box,{children:[(0,h.jsxs)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Folder Name",(0,h.jsx)(d.Text,{color:"red",children:"*"})]}),(0,h.jsx)(t.Input,{fontSize:"sm",onChange:z,value:null===A||void 0===A?void 0:A.folderName,name:"folderName",placeholder:"Enter Folder Name",fontWeight:"500",borderColor:null!==T&&void 0!==T&&T.folderName&&null!==I&&void 0!==I&&I.folderName?"red.300":null}),(0,h.jsxs)(d.Text,{mb:"10px",color:"red",children:[" ",(null===T||void 0===T?void 0:T.folderName)&&(null===I||void 0===I?void 0:I.folderName)&&(null===T||void 0===T?void 0:T.folderName)]})]}),(0,h.jsxs)(d.Box,{children:[(0,h.jsx)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"File Name"}),(0,h.jsx)(t.Input,{fontSize:"sm",onChange:z,value:null===A||void 0===A?void 0:A.filename,name:"filename",placeholder:"Enter File Name",fontWeight:"500",borderColor:null!==T&&void 0!==T&&T.filename&&null!==I&&void 0!==I&&I.filename?"red.300":null}),(0,h.jsxs)(d.Text,{mb:"10px",color:"red",children:[" ",(null===T||void 0===T?void 0:T.filename)&&(null===I||void 0===I?void 0:I.filename)&&(null===T||void 0===T?void 0:T.filename)]})]}),(0,h.jsx)(x.A,{count:null===A||void 0===A||null===(l=A.files)||void 0===l?void 0:l.length,onFileSelect:e=>k("files",e)})," "]}),(0,h.jsxs)(i.jl,{children:[(0,h.jsx)(a.Button,{size:"sm",variant:"brand",mr:2,onClick:F,disabled:!!b,children:b?(0,h.jsx)(v.A,{}):"Save"}),(0,h.jsx)(a.Button,{size:"sm",variant:"outline",colorScheme:"red",onClick:()=>{o(!1),N()},children:"Close"})]})]})]})}},8878:(e,l,o)=>{o.d(l,{A:()=>y});var i=o(4034),d=o(9942),n=o(2554),t=o(4450),a=o(8510),s=o(4626),r=o(9488),v=o(3516),u=o(5043),c=o(3216),m=o(9621),x=o(2030),h=o(8908),p=o(899),j=o(4614),f=o(3388),g=o(6654),C=o(7801),b=o(7508),S=o(579);const y=e=>{var l,o,y;const{data:D}=e,w=JSON.parse(localStorage.getItem("user")),T=(0,b.wA)(),[I,A]=(0,u.useState)(!1),L=Object.fromEntries(null===(l=(null===e||void 0===e||null===(o=e.leadData)||void 0===o?void 0:o.fields)||[])||void 0===l?void 0:l.map((e=>[null===e||void 0===e?void 0:e.name,""]))),[z,F]=(0,u.useState)(!1),[k,N]=(0,u.useState)([]),[Y,B]=(0,u.useState)(!1),[W,O]=(0,u.useState)([]),[M,G]=(0,u.useState)({...L,createBy:JSON.parse(localStorage.getItem("user"))._id}),_=(0,c.g)(),H=(0,v.Wx)({initialValues:M,enableReinitialize:!0,validationSchema:p.object().shape((0,x.g)(null===e||void 0===e||null===(y=e.leadData)||void 0===y?void 0:y.fields)),onSubmit:(e,l)=>{let{resetForm:o}=l;Q()}}),{errors:E,touched:V,values:U,handleBlur:$,handleChange:R,handleSubmit:P,setFieldValue:J}=H,Q=async()=>{try{A(!0);let l=await(0,m.yP)(`api/form/edit/${(null===_||void 0===_?void 0:_.id)||(null===e||void 0===e?void 0:e.selectedId)}`,{...U,moduleId:null===e||void 0===e?void 0:e.moduleId});200===(null===l||void 0===l?void 0:l.status)&&(e.onClose(),e.setAction((e=>!e)),T((0,C.T)()))}catch(l){console.log(l)}finally{A(!1)}};(0,u.useEffect)((()=>{(async()=>{let e=await(0,m.x4)("superAdmin"===(null===w||void 0===w?void 0:w.role)?"api/property":`api/property/?createBy=${null===w||void 0===w?void 0:w._id}`);N(null===e||void 0===e?void 0:e.data)})()}),[]);const K=()=>{e.onClose(!1),e.setSelectedId&&(null===e||void 0===e||e.setSelectedId()),H.resetForm()};let q;(0,u.useEffect)((()=>{(async()=>{if(D)G((e=>{var l;return{...e,...D,associatedListing:null===D||void 0===D||null===(l=D.associatedListing)||void 0===l?void 0:l._id}}));else if(null!==e&&void 0!==e&&e.selectedId)try{var l,o;A(!0),q=await(0,m.x4)("api/lead/view/",null===e||void 0===e?void 0:e.selectedId);let i=null===(l=q)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.lead;G((e=>{var l;return{...e,...i,associatedListing:null===i||void 0===i||null===(l=i.associatedListing)||void 0===l?void 0:l._id}}))}catch(i){console.error(i)}finally{A(!1)}})()}),[null===e||void 0===e?void 0:e.selectedId,D]),(0,u.useEffect)((()=>{Z()}),[]);const Z=async()=>{var e;let l=await(0,m.x4)("api/user/");O(null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.user)};return(0,S.jsx)("div",{children:(0,S.jsxs)(d._s,{isOpen:null===e||void 0===e?void 0:e.isOpen,size:null===e||void 0===e?void 0:e.size,children:[(0,S.jsx)(d.QP,{}),(0,S.jsxs)(d.zj,{children:[(0,S.jsxs)(d.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Edit ",(null===U||void 0===U?void 0:U.leadName)||"Lead ",(0,S.jsx)(n.IconButton,{onClick:K,icon:(0,S.jsx)(i.CloseIcon,{})})]}),(0,S.jsxs)(d.ys,{children:[I?(0,S.jsx)(t.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,S.jsx)(r.A,{})}):(0,S.jsx)(h.A,{moduleData:null===e||void 0===e?void 0:e.leadData,values:U,setFieldValue:J,handleChange:R,handleBlur:$,errors:E,touched:V}),(0,S.jsx)(t.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,mt:2,children:(0,S.jsxs)(t.GridItem,{colSpan:{base:12},children:[(0,S.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Associated Listing"}),(0,S.jsxs)(t.Flex,{justifyContent:"space-between",children:[(0,S.jsx)(s.l6,{value:(null===U||void 0===U?void 0:U.associatedListing)||"",name:"associatedListing",onChange:R,fontWeight:"500",placeholder:"select associated listing",children:null===k||void 0===k?void 0:k.map((e=>(0,S.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id)))}),(0,S.jsx)(n.IconButton,{onClick:()=>F(!0),ml:2,fontSize:"25px",icon:(0,S.jsx)(f.G2h,{})})]})]})}),(0,S.jsx)(t.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,mt:2,children:(0,S.jsxs)(t.GridItem,{colSpan:{base:12},children:[(0,S.jsx)(a.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Assign to User"}),(0,S.jsxs)(t.Flex,{justifyContent:"space-between",children:[(0,S.jsx)(s.l6,{value:null===U||void 0===U?void 0:U.assignUser,name:"assignUser",onChange:R,fontWeight:"500",placeholder:"select user",children:null===W||void 0===W?void 0:W.map((e=>(0,S.jsxs)("option",{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.firstName," ",null===e||void 0===e?void 0:e.lastName]},null===e||void 0===e?void 0:e._id)))}),(0,S.jsx)(n.IconButton,{onClick:()=>B(!0),ml:2,fontSize:"25px",icon:(0,S.jsx)(f.G2h,{})})]})]})})]}),(0,S.jsx)(g.A,{onClose:()=>F(!1),isOpen:z,data:k,isLoding:I,setIsLoding:A,fieldName:"associatedListing",setFieldValue:J}),(0,S.jsx)(j.A,{onClose:()=>B(!1),isOpen:Y,fieldName:"assignUser",setFieldValue:J,data:W,isLoding:I,setIsLoding:A}),(0,S.jsxs)(d.tb,{children:[(0,S.jsx)(n.Button,{sx:{textTransform:"capitalize"},variant:"brand",size:"sm",type:"submit",disabled:!!I,onClick:P,children:I?(0,S.jsx)(r.A,{}):"Update"}),(0,S.jsx)(n.Button,{variant:"outline",colorScheme:"red",size:"sm",sx:{marginLeft:2,textTransform:"capitalize"},onClick:K,children:"Close"})]})]})]})})}},9066:(e,l,o)=>{o.d(l,{A:()=>A});var i=o(9942),d=o(4450),n=o(8510),t=o(7682),a=o(5104),s=o(2554),r=o(3186),v=o(968),u=o(5043),c=o(1046),m=o(9488),x=o(850),h=o(6547),p=o(8860),j=o(7508),f=o(579);const g=e=>{var l,o;const{onClose:n,isOpen:t,fieldName:a,setFieldValue:r,data:v}=e,[g,C]=(0,u.useState)([]),[b,S]=(0,u.useState)([]),[y,D]=(0,u.useState)([]),[w,T]=(0,u.useState)(!1),I=(0,j.wA)();(0,u.useEffect)((async()=>{await I((0,h.h)()),(async()=>{var e,l,o,i;T(!0);const d=await I((0,x.I)());D(null===d||void 0===d||null===(e=d.payload)||void 0===e?void 0:e.data);const n=[{Header:"#",accessor:"_id",isSortable:!1,width:10},...((null===d||void 0===d||null===(l=d.payload)||void 0===l||null===(o=l.data)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.fields)||[]).filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))).map((e=>({Header:null===e||void 0===e?void 0:e.label,accessor:null===e||void 0===e?void 0:e.name})))];S(n),T(!1)})()}),[]);JSON.parse(localStorage.getItem("user"));const A=[...new Set(g)];return(0,f.jsxs)(i.aF,{onClose:n,size:"full",isOpen:t,children:[(0,f.jsx)(i.mH,{}),(0,f.jsxs)(i.$m,{children:[(0,f.jsx)(i.rQ,{children:"Select Contact"}),(0,f.jsx)(i.s_,{}),(0,f.jsx)(i.cw,{children:w?(0,f.jsx)(d.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,f.jsx)(m.A,{})}):(0,f.jsx)(c.A,{title:"Contacts",isLoding:w,allData:v,tableData:v,type:"multi",tableCustomFields:(null===y||void 0===y||null===(l=y[0])||void 0===l||null===(o=l.fields)||void 0===o?void 0:o.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||[],selectedValues:g,setSelectedValues:C,columnsData:null!==b&&void 0!==b?b:[]})}),(0,f.jsxs)(i.jl,{children:[(0,f.jsxs)(s.Button,{variant:"brand",onClick:async()=>{try{T(!0),r(a,A),n()}catch(e){console.log(e)}finally{T(!1)}},disabled:!!w,leftIcon:(0,f.jsx)(p.NLY,{}),children:[" ",w?(0,f.jsx)(m.A,{}):"Select"]}),(0,f.jsx)(s.Button,{onClick:()=>n(),children:"Close"})]})]})]})};var C=o(7952),b=o(446),S=o.n(b),y=o(3516),D=o(3388),w=o(2145),T=o(9849),I=o(9621);const A=e=>{var l,o;const{onClose:c,isOpen:x,setAction:h,from:p,fetchData:b,view:A,leadName:L}=e,[z,F]=(0,u.useState)([]),[k,N]=(0,u.useState)([]),[Y,B]=(0,u.useState)(!1),[W,O]=(0,u.useState)(!1),[M,G]=(0,u.useState)(!1),_=(new Date).toISOString().split(".")[0],H=(0,j.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.leadData)||void 0===l?void 0:l.data})),[E,V]=(0,u.useState)([]),[U,$]=(0,u.useState)([]),R=JSON.parse(localStorage.getItem("user")),P=(0,j.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.contactData)||void 0===l?void 0:l.data})),J={agenda:"",attendes:"contactView"===(null===e||void 0===e?void 0:e.leadContect)&&null!==e&&void 0!==e&&e.id?[null===e||void 0===e?void 0:e.id]:[],attendesLead:"leadView"===(null===e||void 0===e?void 0:e.leadContect)&&null!==e&&void 0!==e&&e.id?[null===e||void 0===e?void 0:e.id]:[],location:"",related:"contactView"===(null===e||void 0===e?void 0:e.leadContect)?"Contact":"leadView"===(null===e||void 0===e?void 0:e.leadContect)?"Lead":"None",dateTime:"",notes:"",createBy:null===R||void 0===R?void 0:R._id},Q=(0,y.Wx)({initialValues:J,validationSchema:T.pq,onSubmit:(e,l)=>{let{resetForm:o}=l;ie()}}),{errors:K,touched:q,values:Z,handleBlur:X,handleChange:ee,handleSubmit:le,setFieldValue:oe}=Q,ie=(null===z||void 0===z||z.find((e=>(null===e||void 0===e?void 0:e.leadName)===(null===L||void 0===L?void 0:L.leadName))),async()=>{try{var l,o;if(B(!0),(null===Z||void 0===Z||null===(l=Z.attendes)||void 0===l?void 0:l.length)>0||(null===Z||void 0===Z||null===(o=Z.attendesLead)||void 0===o?void 0:o.length)>0){let l=await(0,I.d_)("api/meeting/add",Z);200===(null===l||void 0===l?void 0:l.status)&&(Q.resetForm(),e.onClose(),b(1))}else w.oR.error("Select Related To")}catch(i){console.log(i)}finally{B(!1)}});(0,u.useEffect)((()=>{(async()=>{if(!0===A)"Contact"===(null===Z||void 0===Z?void 0:Z.related)&&(null===k||void 0===k?void 0:k.length)<=0?N(P):"Lead"===(null===Z||void 0===Z?void 0:Z.related)&&(null===z||void 0===z?void 0:z.length)<=0&&F(H);else{let o;var e;if("Contact"===(null===Z||void 0===Z?void 0:Z.related)&&(null===k||void 0===k?void 0:k.length)<=0)o=await(0,I.x4)("superAdmin"===R.role?"api/contact/":`api/contact/?createBy=${null===R||void 0===R?void 0:R._id}`),N(null===(e=o)||void 0===e?void 0:e.data);else if("Lead"===(null===Z||void 0===Z?void 0:Z.related)&&(null===z||void 0===z?void 0:z.length)<=0){var l;o=await(0,I.x4)("superAdmin"===(null===R||void 0===R?void 0:R.role)?"api/lead/":`api/lead/?createBy=${null===R||void 0===R?void 0:R._id}`),F(null===(l=o)||void 0===l?void 0:l.data)}}})()}),[null===e||void 0===e?void 0:e.id,null===Z||void 0===Z?void 0:Z.related]);return(0,u.useEffect)((()=>{const e="Contact"===(null===Z||void 0===Z?void 0:Z.related)?k:H;V(e);const l=null!==Array&&void 0!==Array&&Array.isArray(e)?null===e||void 0===e?void 0:e.map((e=>({...e,value:null===e||void 0===e?void 0:e._id,label:"Contact"===(null===Z||void 0===Z?void 0:Z.related)?null===e||void 0===e?void 0:e.fullName:null===e||void 0===e?void 0:e.leadName}))):[];$(l)}),[H,null===Z||void 0===Z?void 0:Z.related,k]),(0,f.jsxs)(i.aF,{onClose:c,isOpen:x,isCentered:!0,children:[(0,f.jsx)(i.mH,{}),(0,f.jsxs)(i.$m,{height:"580px",children:[(0,f.jsx)(i.rQ,{children:"Add Meeting "}),(0,f.jsx)(i.s_,{}),(0,f.jsxs)(i.cw,{overflowY:"auto",height:"400px",children:[(0,f.jsx)(g,{data:k,isOpen:W,onClose:O,fieldName:"attendes",setFieldValue:oe}),(0,f.jsx)(C.A,{data:z,isOpen:M,onClose:G,fieldName:"attendesLead",setFieldValue:oe}),(0,f.jsxs)(d.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:[(0,f.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,f.jsxs)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Agenda",(0,f.jsx)(d.Text,{color:"red",children:"*"})]}),(0,f.jsx)(t.Input,{fontSize:"sm",onChange:ee,onBlur:X,value:null===Z||void 0===Z?void 0:Z.agenda,name:"agenda",placeholder:"Agenda",fontWeight:"500",borderColor:null!==K&&void 0!==K&&K.agenda&&null!==q&&void 0!==q&&q.agenda?"red.300":null}),(0,f.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===K||void 0===K?void 0:K.agenda)&&(null===q||void 0===q?void 0:q.agenda)&&(null===K||void 0===K?void 0:K.agenda)]})]}),(0,f.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,f.jsxs)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Related To",(0,f.jsx)(d.Text,{color:"red",children:"*"})]}),(0,f.jsx)(a.z6,{onChange:e=>oe("related",e),value:null===Z||void 0===Z?void 0:Z.related,children:(0,f.jsxs)(d.Stack,{direction:"row",children:["contactView"===(null===e||void 0===e?void 0:e.leadContect)&&(0,f.jsx)(a.sx,{value:"Contact",children:"Contact"}),"leadView"===(null===e||void 0===e?void 0:e.leadContect)&&(0,f.jsx)(a.sx,{value:"Lead",children:"Lead"}),!(null!==e&&void 0!==e&&e.leadContect)&&(0,f.jsxs)(f.Fragment,{children:[" ",(0,f.jsx)(a.sx,{value:"Contact",children:"Contact"}),(0,f.jsx)(a.sx,{value:"Lead",children:"Lead"})]})]})}),(0,f.jsxs)(d.Text,{mb:"10px",color:"red",fontSize:"sm",children:[" ",(null===K||void 0===K?void 0:K.related)&&(null===q||void 0===q?void 0:q.related)&&(null===K||void 0===K?void 0:K.related)]})]}),("Contact"===(null===Z||void 0===Z?void 0:Z.related)?(null!==(l=null===k||void 0===k?void 0:k.length)&&void 0!==l?l:0)>0:(null!==(o=null===z||void 0===z?void 0:z.length)&&void 0!==o?o:0)>0)&&(null===Z||void 0===Z?void 0:Z.related)&&(0,f.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,f.jsxs)(d.Flex,{alignItems:"end",justifyContent:"space-between",children:[(0,f.jsx)(d.Text,{w:"100%",children:(0,f.jsx)(v.CUIAutoComplete,{label:`Choose Preferred Attendes ${"Contact"===(null===Z||void 0===Z?void 0:Z.related)?"Contact":"Lead"===(null===Z||void 0===Z?void 0:Z.related)&&"Lead"}`,placeholder:"Type a Name",name:"attendes",items:U,className:"custom-autoComplete",selectedItems:null===U||void 0===U?void 0:U.filter((e=>{var l,o;return"Contact"===(null===Z||void 0===Z?void 0:Z.related)?null===Z||void 0===Z||null===(l=Z.attendes)||void 0===l?void 0:l.includes(null===e||void 0===e?void 0:e._id):"Lead"===(null===Z||void 0===Z?void 0:Z.related)&&(null===Z||void 0===Z||null===(o=Z.attendesLead)||void 0===o?void 0:o.includes(null===e||void 0===e?void 0:e._id))})),onSelectedItemsChange:e=>{const l=null===(o=null===e||void 0===e?void 0:e.selectedItems)||void 0===o?void 0:o.map((e=>null===e||void 0===e?void 0:e._id));var o;"Contact"===(null===Z||void 0===Z?void 0:Z.related)?oe("attendes",l):"Lead"===(null===Z||void 0===Z?void 0:Z.related)&&oe("attendesLead",l)}})}),(0,f.jsx)(s.IconButton,{mb:6,onClick:()=>"Contact"===(null===Z||void 0===Z?void 0:Z.related)?O(!0):"Lead"===(null===Z||void 0===Z?void 0:Z.related)&&G(!0),fontSize:"25px",icon:(0,f.jsx)(D.G2h,{})})]}),(0,f.jsxs)(d.Text,{color:"red",children:[" ",(null===K||void 0===K?void 0:K.attendes)&&(null===q||void 0===q?void 0:q.attendes)&&(null===K||void 0===K?void 0:K.attendes)]})]}),(0,f.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,f.jsx)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Location"}),(0,f.jsx)(t.Input,{fontSize:"sm",onChange:ee,onBlur:X,value:null===Z||void 0===Z?void 0:Z.location,name:"location",placeholder:"Location",fontWeight:"500",borderColor:null!==K&&void 0!==K&&K.location&&null!==q&&void 0!==q&&q.location?"red.300":null}),(0,f.jsxs)(d.Text,{mb:"10px",color:"red",fontSize:"sm",children:[" ",(null===K||void 0===K?void 0:K.location)&&(null===q||void 0===q?void 0:q.location)&&(null===K||void 0===K?void 0:K.location)]})]}),(0,f.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,f.jsxs)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:["Date Time",(0,f.jsx)(d.Text,{color:"red",children:"*"})]}),(0,f.jsx)(t.Input,{fontSize:"sm",type:"datetime-local",onChange:ee,onBlur:X,min:S()(_).format("YYYY-MM-DD HH:mm"),value:null===Z||void 0===Z?void 0:Z.dateTime,name:"dateTime",placeholder:"Date Time",fontWeight:"500",borderColor:null!==K&&void 0!==K&&K.dateTime&&null!==q&&void 0!==q&&q.dateTime?"red.300":null}),(0,f.jsxs)(d.Text,{fontSize:"sm",mb:"10px",color:"red",children:[" ",(null===K||void 0===K?void 0:K.dateTime)&&(null===q||void 0===q?void 0:q.dateTime)&&(null===K||void 0===K?void 0:K.dateTime)]})]}),(0,f.jsxs)(d.GridItem,{colSpan:{base:12},children:[(0,f.jsx)(n.FormLabel,{display:"flex",ms:"4px",fontSize:"sm",fontWeight:"500",mb:"8px",children:"Notes"}),(0,f.jsx)(r.T,{resize:"none",fontSize:"sm",placeholder:"Notes",onChange:ee,onBlur:X,value:null===Z||void 0===Z?void 0:Z.notes,name:"notes",fontWeight:"500",borderColor:null!==K&&void 0!==K&&K.notes&&null!==q&&void 0!==q&&q.notes?"red.300":null}),(0,f.jsxs)(d.Text,{mb:"10px",color:"red",children:[" ",(null===K||void 0===K?void 0:K.notes)&&(null===q||void 0===q?void 0:q.notes)&&(null===K||void 0===K?void 0:K.notes)]})]})]})]}),(0,f.jsxs)(i.jl,{children:[(0,f.jsx)(s.Button,{size:"sm",variant:"brand",me:2,disabled:!!Y,onClick:le,children:Y?(0,f.jsx)(m.A,{}):"Save"}),(0,f.jsx)(s.Button,{sx:{textTransform:"capitalize"},variant:"outline",colorScheme:"red",size:"sm",onClick:()=>{Q.resetForm(),c()},children:"Close"})]})]})]})}}}]);
//# sourceMappingURL=9009.e47ea46d.chunk.js.map