"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[8259],{8259:(e,l,i)=>{i.r(l),i.d(l,{default:()=>E});var o=i(4034),t=i(1206),n=i(9754),d=i(4450),r=i(8858),s=i(5376),a=i(2554),u=i(7682),c=(i(962),i(216)),v=i(3994),m=i(9488),p=(i(2770),i(5043)),x=i(4960),h=i(3216),j=i(5475),g=i(2145),y=i(9621),b=(i(4406),i(6),i(9066)),f=(i(9250),i(5574)),S=(i(2853),i(9702),i(8618),i(8177)),C=i(8031),I=i(6178),A=i.n(I),D=i(1887),w=i(7508),q=i(5369),k=i(74),O=i.n(k),F=i(3516),B=i(899),T=i(5144),G=i(3288),z=i(3915),P=i(579);const E=e=>{var l,i,I,k,E,R,N,_,V,W,H,M;const{userAction:U,userData:Y,editData:$,selectedId:J,setUserAction:L}=e,Z=(0,h.g)(),K=(0,w.wA)(),Q=(0,h.Zp)(),{id:X}=Z,ee=JSON.parse(localStorage.getItem("user")),[le,ie]=("string"===typeof Y&&JSON.parse(Y),(0,t.dU)("gray.500","white"),(0,p.useState)([])),[oe,te]=(0,p.useState)([]),{isOpen:ne,onOpen:de,onClose:re}=(0,n.j1)(),[se,ae]=(0,p.useState)(!1),[ue,ce]=(0,p.useState)(!1),[ve,me]=(0,p.useState)(!1),[pe,xe]=(0,p.useState)(!1),[he,je]=(0,p.useState)(!1),[ge,ye]=(0,p.useState)(null),[be,fe]=(0,p.useState)(!1),[Se,Ce]=(0,p.useState)(0),[Ie,Ae]=(0,p.useState)(),[De,we]=(0,p.useState)(!1),[qe,ke]=(0,p.useState)([]),[Oe,Fe]=(0,p.useState)([]),[Be,Te]=(0,p.useState)([]),[Ge]=((0,w.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.propertyData)||void 0===l?void 0:l.data})),(0,w.d4)((e=>{var l,i;return null===e||void 0===e||null===(l=e.leadCustomFiled)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.data})),(0,f.h)(["Opportunity Project"])),ze=async()=>{if(X){var e;const l=await(0,y.x4)("api/opportunityproject/view/",X);ie(null===l||void 0===l?void 0:l.data),Te(null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.propertyOpportunityProject)}};(0,p.useEffect)((()=>{ze()}),[X,se]);const Pe=(e,l)=>{Ve.setFieldValue(e,l),ye(e)};(0,p.useEffect)((async()=>{await K((0,G.g)()),(async()=>{var e,l,i,o,t,n;me(!0);const d=await K((0,z.R)());ke(null===d||void 0===d||null===(e=d.payload)||void 0===e?void 0:e.data);const r=[{Header:"#",accessor:"_id",isSortable:!1,width:10},...null===(l=(null===d||void 0===d||null===(o=d.payload)||void 0===o||null===(t=o.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.fields)||[])||void 0===l||null===(i=l.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||void 0===i?void 0:i.map((e=>({Header:null===e||void 0===e?void 0:e.label,accessor:null===e||void 0===e?void 0:e.name})))];Fe(r),me(!1)})()}),[]);(0,p.useEffect)((()=>{ze()}),[he]);const Ee=null===Object||void 0===Object?void 0:Object.values(Z)[0],Re=null===Ee||void 0===Ee?void 0:Ee.split("/"),Ne={name:null===le||void 0===le?void 0:le.name,requirement:null===le||void 0===le?void 0:le.requirement},_e=B.object({name:B.string().required("name is required"),requirement:B.string().required("Requirement is required")}),Ve=(0,F.Wx)({initialValues:Ne,validationSchema:_e,enableReinitialize:!0,onSubmit:async e=>{ye(null),Le()}}),{errors:We,touched:He,values:Me,handleChange:Ue,handleSubmit:Ye,setFieldValue:$e,resetForm:Je}=Ve,Le=async()=>{try{me(!0);let i=await(0,y.yP)(`api/opportunityproject/edit/${null===Z||void 0===Z?void 0:Z.id}`,Me);if(i&&200===(null===i||void 0===i?void 0:i.status)){ye(null),ze();let e=Y;if((null===ee||void 0===ee?void 0:ee._id)===(null===Z||void 0===Z?void 0:Z.id)){e&&"object"===typeof e&&(e={...e,Name:null===Me||void 0===Me?void 0:Me.name,Requirement:null===Me||void 0===Me?void 0:Me.requirement});const l=JSON.stringify(e);localStorage.setItem("user",l)}re(),L(""),je((e=>!e))}else{var e,l;g.oR.error(null===i||void 0===i||null===(e=i.response)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.message)}}catch(i){console.log(i)}finally{me(!1)}},Ze=e=>{Ve.handleSubmit()},[Ke,Qe]=(0,f.h)(["Contacts","Leads"]);return(0,P.jsxs)(P.Fragment,{children:[ve?(0,P.jsx)(d.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,P.jsx)(m.A,{})}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(d.Heading,{size:"lg",mt:0,m:3,children:(null===le||void 0===le?void 0:le.name)||""}),(0,P.jsx)(r.tU,{onChange:e=>{Ce(e)},index:Se,style:{background:"#ffffff",borderRadius:"20px",padding:"20px"},children:(0,P.jsxs)(d.Grid,{templateColumns:"repeat(4, 1fr)",mb:3,gap:1,id:"reports",children:[(0,P.jsx)(d.GridItem,{colSpan:{base:4},children:(0,P.jsx)(r.wb,{sx:{border:"none","& button:focus":{boxShadow:"none"},"& button":{margin:{sm:"0 3px",md:"0 5px"},padding:{sm:"5px",md:"8px"},border:"2px solid #8080803d",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",borderBottom:0,fontSize:{sm:"12px",md:"16px"}},'& button[aria-selected="true"]':{border:"2px solid brand.200",borderBottom:0,zIndex:"0"}}})}),(0,P.jsx)(d.GridItem,{colSpan:{base:2,md:4},mt:{sm:"3px",md:"5px"},children:(0,P.jsx)(d.GridItem,{colSpan:2,children:(0,P.jsxs)(d.Box,{children:[(0,P.jsxs)(d.Box,{display:"flex",justifyContent:"space-between",children:[(0,P.jsx)(d.Heading,{size:"md",mb:3,children:"Opportunity Project Details"}),(0,P.jsxs)(d.Flex,{id:"hide-btn",children:[(0,P.jsxs)(s.W1,{children:[("superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||(null===Ge||void 0===Ge?void 0:Ge.create)||(null===Ge||void 0===Ge?void 0:Ge.update)||(null===Ge||void 0===Ge?void 0:Ge.delete))&&(0,P.jsx)(s.IU,{size:"sm",variant:"outline",colorScheme:"blackAlpha",mr:2.5,as:a.Button,rightIcon:(0,P.jsx)(o.ChevronDownIcon,{}),children:"Actions"}),(0,P.jsx)(s.Nj,{}),(0,P.jsxs)(s.cO,{minWidth:2,children:[("superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||(null===Ge||void 0===Ge?void 0:Ge.create))&&(0,P.jsxs)(s.Dr,{color:"blue",onClick:()=>{fe("add"),de()},alignItems:"start",icon:(0,P.jsx)(o.AddIcon,{}),children:[" ","Add"," "]}),("superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||(null===Ge||void 0===Ge?void 0:Ge.update))&&(0,P.jsx)(s.Dr,{onClick:()=>{fe("edit"),de()},alignItems:"start",icon:(0,P.jsx)(o.EditIcon,{}),children:"Edit"}),(0,P.jsx)(s.Dr,{onClick:()=>{const e=document.getElementById("reports"),l=document.getElementById("hide-btn");e?(l.style.display="none",e.style.width="100%",e.style.height="auto",e.style.padding="15px",O()().from(e).set({margin:[0,0,0,0],filename:`OpportunityProject_Details_${A()().format("DD-MM-YYYY")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}}).save().then((()=>{e.style.display="",l.style.display="",e.style.padding=""}))):console.error("Element with ID 'reports' not found.")},alignItems:"start",icon:(0,P.jsx)(q.kl1,{}),display:"flex",style:{alignItems:"center"},children:"Print as PDF"}),("superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||(null===Ge||void 0===Ge?void 0:Ge.delete))&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(s.Nj,{}),(0,P.jsx)(s.Dr,{alignItems:"start",color:"red",onClick:()=>ce(!0),icon:(0,P.jsx)(o.DeleteIcon,{}),children:"Delete"})]})]})]}),(0,P.jsx)(j.N_,{to:"/opportunityproject",children:(0,P.jsx)(a.Button,{leftIcon:(0,P.jsx)(x.m6W,{}),size:"sm",variant:"brand",children:"Back"})})]})]}),(0,P.jsx)(v.E,{})]})})}),(0,P.jsx)(d.GridItem,{colSpan:{base:4,md:2},mt:3,children:(0,P.jsxs)(d.Box,{children:[(0,P.jsxs)(d.Text,{fontSize:"sm",fontWeight:"bold",color:"blackAlpha.900",children:[" ","Opportunity Project Name"," "]}),"name"===ge?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.Input,{id:"text",name:"name",type:"text",onChange:null===Ve||void 0===Ve?void 0:Ve.handleChange,onBlur:Ze,value:null===Ve||void 0===Ve||null===(l=Ve.values)||void 0===l?void 0:l.name,borderColor:null!==Ve&&void 0!==Ve&&null!==(i=Ve.errors)&&void 0!==i&&i.name&&null!==Ve&&void 0!==Ve&&null!==(I=Ve.touched)&&void 0!==I&&I.name?"red.300":null,autoFocus:!0}),(0,P.jsxs)(d.Text,{mb:"10px",color:"red",children:[" ",(null===Ve||void 0===Ve?void 0:Ve.errors.name)&&(null===Ve||void 0===Ve?void 0:Ve.touched.name)&&(null===Ve||void 0===Ve?void 0:Ve.errors.name)]})]}):(0,P.jsx)(d.Text,{onDoubleClick:()=>Pe("name",null===le||void 0===le?void 0:le.name),children:null!==le&&void 0!==le&&le.name?null===le||void 0===le?void 0:le.name:" - "})]})}),(0,P.jsx)(d.GridItem,{colSpan:{base:4,md:2},mt:3,children:(0,P.jsxs)(d.Box,{children:[(0,P.jsxs)(d.Text,{fontSize:"sm",fontWeight:"bold",color:"blackAlpha.900",children:["Opportunity Project Requirement"," "]}),"requirement"===ge?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.Input,{id:"text",name:"requirement",type:"text",onChange:Ve.handleChange,onBlur:Ze,value:null===Ve||void 0===Ve||null===(k=Ve.values)||void 0===k?void 0:k.requirement,borderColor:null!==Ve&&void 0!==Ve&&null!==(E=Ve.errors)&&void 0!==E&&E.requirement&&null!==Ve&&void 0!==Ve&&null!==(R=Ve.touched)&&void 0!==R&&R.requirement?"red.300":null,autoFocus:!0}),(0,P.jsxs)(d.Text,{mb:"10px",color:"red",children:[" ",(null===Ve||void 0===Ve||null===(N=Ve.errors)||void 0===N?void 0:N.requirement)&&(null===Ve||void 0===Ve||null===(_=Ve.touched)||void 0===_?void 0:_.requirement)&&(null===Ve||void 0===Ve||null===(V=Ve.errors)||void 0===V?void 0:V.requirement)]})]}):(0,P.jsx)(d.Text,{onDoubleClick:()=>Pe("requirement",null===le||void 0===le?void 0:le.requirement),children:null!==le&&void 0!==le&&le.requirement?null===le||void 0===le?void 0:le.requirement:" - "})]})}),(0,P.jsx)(d.Grid,{children:(0,P.jsxs)(d.GridItem,{colSpan:{base:6},mt:3,children:[(0,P.jsxs)(d.Text,{fontSize:"sm",fontWeight:"bold",color:"blackAlpha.900",children:[" ","Assign To"," "]}),(0,P.jsx)(j.N_,{to:null!==le&&void 0!==le&&le.contact?(null===Ke||void 0===Ke?void 0:Ke.view)&&`/contactView/${null===le||void 0===le?void 0:le.contact}`:(null===Qe||void 0===Qe?void 0:Qe.view)&&`/leadView/${null===le||void 0===le?void 0:le.lead}`,children:(0,P.jsx)(d.Text,{color:"contact"===(null===le||void 0===le?void 0:le.category)&&(null!==Ke&&void 0!==Ke&&Ke.view||"superAdmin"===(null===ee||void 0===ee?void 0:ee.role))||null!==Qe&&void 0!==Qe&&Qe.view||"superAdmin"===(null===ee||void 0===ee?void 0:ee.role)&&"lead"===(null===le||void 0===le?void 0:le.category)?"brand.600":"blackAlpha.900",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},children:null!==le&&void 0!==le&&le.setCategory?null===le||void 0===le?void 0:le.setCategory:" - "})})]})})]})}),(0,P.jsx)(c.A,{mt:3,children:(0,P.jsx)(d.Grid,{templateColumns:"repeat(2, 1fr)",gap:1,children:(0,P.jsx)(d.GridItem,{colSpan:{base:12},children:(0,P.jsx)(C.A,{title:"Property",isLoding:ve,columnData:null!==Oe&&void 0!==Oe?Oe:[],allData:null!==Be&&void 0!==Be?Be:[],tableData:null!==Be&&void 0!==Be?Be:[],tableCustomFields:(null===qe||void 0===qe||null===(W=qe[0])||void 0===W||null===(H=W.fields)||void 0===H?void 0:H.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||[],AdvanceSearch:()=>"",ManageGrid:!1,deleteMany:!1,selectedValues:Ie,setSelectedValues:Ae,selectType:"single",customSearch:!1,checkBox:!1})})})}),("superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||(null===Ge||void 0===Ge?void 0:Ge.update)||(null===Ge||void 0===Ge?void 0:Ge.delete))&&(0,P.jsx)(c.A,{mt:3,children:(0,P.jsx)(d.Grid,{templateColumns:"repeat(2, 1fr)",gap:1,children:(0,P.jsx)(d.GridItem,{colStart:6,children:(0,P.jsxs)(d.Flex,{justifyContent:"right",children:["superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||null!==Ge&&void 0!==Ge&&Ge.update?(0,P.jsx)(a.Button,{size:"sm",onClick:()=>{fe("edit"),de()},leftIcon:(0,P.jsx)(o.EditIcon,{}),mr:2.5,variant:"outline",colorScheme:"green",children:"Edit"}):"","superAdmin"===(null===ee||void 0===ee?void 0:ee.role)||null!==Ge&&void 0!==Ge&&Ge.delete?(0,P.jsx)(a.Button,{size:"sm",style:{background:"red.800"},onClick:()=>ce(!0),leftIcon:(0,P.jsx)(o.DeleteIcon,{}),colorScheme:"red",children:"Delete"}):""]})})})})]}),(0,P.jsx)(b.A,{fetchData:ze,isOpen:pe,leadContect:null===Re||void 0===Re?void 0:Re[0],onClose:xe,from:"contact",id:null===Z||void 0===Z?void 0:Z.id,setAction:je,view:!0}),(0,P.jsx)(D.A,{isOpen:De,fetchData:ze,leadContect:null===Re||void 0===Re?void 0:Re[0],onClose:we,id:null===Z||void 0===Z?void 0:Z.id,userAction:"add",view:!0}),(0,P.jsx)(S.A,{isOpen:ue,onClose:()=>ce(!1),type:"Opportunity Project",handleDeleteData:async e=>{try{me(!0);let l=await(0,y.Gx)("api/opportunityproject/delete/",e);200===(null===l||void 0===l?void 0:l.status)&&(ce(!1),je((e=>!e)),Q("/opportunityproject"))}catch(l){console.log(l)}finally{me(!1)}},ids:null===Z||void 0===Z?void 0:Z.id}),(0,P.jsx)(T.A,{isOpen:ne,fetchData:ze,userAction:be,selectedId:null===Z||void 0===Z?void 0:Z.id,onClose:re,setAction:je,moduleId:null===le||void 0===le||null===(M=le[0])||void 0===M?void 0:M._id,data:le})]})}}}]);
//# sourceMappingURL=8259.896b35a5.chunk.js.map